{"version":3,"sources":["model/index.tsx","util/categorize.tsx","3rd/index.ts","util/condenser.ts","util/index.tsx","component/loading/index.tsx","component/card-picture/index.tsx","component/link-marker/index.tsx","page/input-panel/const.tsx","page/input-panel/char-picker/index.tsx","page/input-panel/style-picker/index.tsx","page/input-panel/input-train/index.tsx","page/input-panel/index.tsx","page/app-header/index.tsx","const/size.ts","const/position.ts","draw/text.ts","draw/util.ts","draw/predefine.ts","draw/type-ability.ts","draw/image.ts","app.tsx","reportWebVitals.js","index.js"],"names":["defaultTextStyle","fillStyle","shadowColor","shadowOffsetY","shadowOffsetX","shadowBlur","hasShadow","defaultCard","frame","foil","name","nameStyleType","nameStyle","attribute","subFamily","star","picture","pictureCrop","x","y","width","height","unit","aspect","link_map","isPendulum","pendulum_effect","red_scale","blue_scale","type_ability","effect","set_id","atk","def","passcode","sticker","isFirstEdition","creator","frameType","labelColor","labelBackgroundColor","iconList","foilStyleMap","gold","platinum","foilList","color","textStyle","checkXyz","card","checkLink","checkMonster","getCardFrame","find","entry","toLowerCase","JSONCrush","e","n","r","o","includes","String","fromCharCode","push","t","unshift","replace","JSONCrushSwap","length","i","l","f","h","substr","a","charCodeAt","g","indexOf","d","encodeURI","encodeURIComponent","split","join","JSONUncrush","substring","pop","RegExp","createCondenser","minThreshold","maxThreshold","min","max","median","lastEffective","iterateCount","magnitude","reverseSearch","finish","Math","searchDown","reset","getMedian","setMedian","newMedian","setLastEffective","forceMedian","getLastEffective","applyLastEffective","getIterateCount","cardFieldShortenMap","_newKey","cardDataCondenser","shortenMap","crush","condensedCard","Object","keys","forEach","cardKey","cardValue","Array","isArray","newKey","curshedCard","JSON","stringify","reverseCardDataCondenser","normalizedCondensedCard","parse","decodeURIComponent","fullCard","fullKey","shortendValue","shortendKey","randomCharacter","charSet","result","charactersLength","charAt","floor","random","randomSetID","randomPassword","splitEffect","isNormal","effectBody","effectMaterial","materialRegex","materialReplacement","exec","material","effectFlavorCondition","flavorConditionRegex","flavorCondition","body","quoteConvert","text","normalizedString","insertUrlParam","key","value","window","history","pushState","searchParams","URLSearchParams","location","search","set","newurl","protocol","host","pathname","toString","path","Loading","FullView","className","size","ImageCropper","React","forwardRef","forwardedRef","noRedrawNumber","defaultExternalSource","previewCanvasRef","children","ratio","defaultCropInfo","onSourceChange","onImageChange","onTainted","useState","crossorigin","setCrossOrigin","sourceType","setSourceType","internalSource","setInternalSource","isLoading","setLoading","externalSource","setExternalSource","imgRef","useRef","crop","setCrop","completedCrop","setCompletedCrop","onLoad","useCallback","img","current","useEffect","image","canvas","ctx","getContext","scaleX","naturalWidth","scaleY","naturalHeight","pixelRatio","devicePixelRatio","boundingWidth","ceil","getBoundingClientRect","boundingHeight","setTransform","imageSmoothingQuality","drawImage","useImperativeHandle","forceExternalSource","source","cropInfo","Group","onChange","target","Button","addonBefore","placeholder","maxLength","type","accept","files","reader","FileReader","addEventListener","readAsDataURL","disabled","onClick","toBlob","blob","previewUrl","URL","createObjectURL","anchor","document","createElement","download","href","click","revokeObjectURL","generateDownload","style","src","onImageLoaded","onImageError","undefined","cropData","onComplete","ruleOfThirds","LinkMarkChooser","defaultValue","choosenArrow","setChoosenArrow","rotateMap","literalChoosenArrow","map","index","normalizedIndex","overlay","cur","newMap","filter","transform","foilButton","label","toLocaleUpperCase","props","fontWeight","frameButton","backgroundColor","attributeButton","alt","process","iconButton","starButton","stickerButton","CharPicker","targetId","onPick","setTarget","internalOnPick","char","inputTarget","getElementById","myField","myValue","selection","focus","createRange","position","selectionStart","startPos","endPos","selectionEnd","insertAtCursor","onDrag","left","top","id","EllipsisOutlined","container","edge","draggable","throttleDrag","StylePicker","memo","defaultType","undebouncedOnChange","setType","setValue","isColorPickerVisble","setColorPickerVisible","isShadowPickerVisble","setShadowPickerVisible","debounce","setCustomValue","inputValue","curValue","newStyle","overlayClassName","content","hex","visible","placement","CaretUpOutlined","CaretDownOutlined","checked","axis","styles","track","gridRow","thumb","zIndex","xmax","xmin","ymax","ymin","CheckboxTrain","optionList","combinedClass","isChecked","TextArea","Input","onChangeFactory","mutateFunction","valueTransform","RandomButton","seeder","onGenerate","marginLeft","paddingLeft","borderLeft","SyncOutlined","CardInputPanel","currentCard","receivingCanvasRef","onCardChange","isMirrorScale","setMirrorScale","imageCropperRef","setCard","mutateFunc","onFoilChange","onAttributeChange","onSubFamilyChange","onNameChange","onStarChange","onPictureChange","onLinkMapChange","onRedScaleChange","onBlueScaleChange","onPendulumEffectChange","onEffectChange","onATKChange","onDEFChange","onTypeAbilityChange","onSetIDChange","onPasscodeChange","onStickerChange","onCreatorChange","isXyz","isLink","isMonster","displayTypeAbility","setDisplayTypeAbility","displayName","setDisplayName","displayEffect","setDisplayEffect","displayPendulumEffect","setDisplayPendulumEffect","onlineCharPicker","setOnlineCharPicker","ref","forceCardData","frameValue","isST","newTypeAbility","toUpperCase","onFocus","allowClear","ev","rows","trim","AppHeader","fontFamily","rel","ExclamationCircleOutlined","taintedCanvasWarning","display","monsterFontList","fontSize","lineHeight","lineCount","monsterSizeList","pendulumFontList","pendulumSizeList","stFontList","stSizeList","typeSizeMap","small","bracketSize","bracketSpace","bracketOffsetTop","upperCaseSize","upperCaseScale","lowerCaseSize","lowerCaseScale","spaceScale","spaceSize","frontSpace","behindSpace","iconSpace","medium","large","arrowPositionList","foilPosition","art","drawScale","baseline","digitList","totalWidth","digit","measureText","accLeft","fillText","drawEffect","isPendulumEffect","fontList","sizeList","normalizedContent","effectIndexSize","tolerantPerSentence","additionalLineCount","sentencizeText","bulletSymbol","specialSymbol","tokenizeR","specialSymbolReg","basedWidth","condenser","effectiveRatio","maxLine","font","textAlign","switchFont","func","tempFont","largeSize","lineList","reduce","prev","curr","condenseRatio","hypoWidth","tokenizedText","currentLineCount","tokenSentence","cnt","tokenWidth","test","fullString","fullStringSplittedByBullet","isLast","drawBullet","beginPath","arc","PI","fill","lineWidth","strokeStyle","stroke","clearRect","actualWidth","scale","sigmoidRatio","splitter","spaceSeparatedText","nonSpaceWidth","spaceCount","spaceWidth","fillTextLeftWithSpacing","str","letterSpacingRatio","charList","curLeft","fillTextRightWithSpacing","curRight","c","drawCreatorText","symbol","maxWidth","splittedContent","splittedWidth","symbolWidth","totalCondensableWidth","returnBundle","measureWithSymbol","nextEdge","drawAD","nextWidth","arr","curText","drawBracketTemplate","alignment","bracketChar","alignmentOffset","drawIconSpaceTemplate","drawBracketSpaceTemplate","drawTextTemplate","spaceChar","drawSlashTemplate","baseOffset","totalOffset","upperChar","imageCacheMap","drawFromSource","sx","sy","Promise","resolve","ready","normalizedX","normalizedY","Image","onload","onerror","drawFromSourceWithSize","dw","dh","App","isInitializing","setInitializing","error","setError","cardInputRef","drawCanvasRef","frameCanvasRef","artCanvasRef","specialFrameCanvasRef","subFamilyCanvasRef","pendulumScaleCanvasRef","pendulumEffectCanvasRef","typeCanvasRef","effectCanvasRef","nameCanvasRef","attributeCanvasRef","ADCanvasRef","setIdRef","passcodeRef","creatorRef","stickerRef","pendulumSize","drawingPipeline","specialFrame","imageChangeCount","setImageChangeCount","cardType","hasFoil","previewCtx","foiledBorder","all","parseInt","counter","offset","normalizedSubFamily","splittedText","contentWidth","drawName","endOfPasscode","draw1stEdition","drawTypeAbility","textSize","instructionList","totalLeft","reverse","typeCtx","WebFont","load","custom","families","urls","active","localCardVersion","localStorage","getItem","localCardData","urlParam","get","inactive","pendingSave","exportRef","currentPipeline","queuedPipeline","canvasRef","link","toDataURL","setTainted","alert","querySelector","classList","remove","isTainted","relevant","setItem","setAttribute","onExport","exportProps","exportCtx","generateLayer","canvasLayer","layerData","layer","values","callDraw","layerList","currentlayer","onDrop","backgroundImage","add","onSave","prompt","cardData","decodedCard","LoadingOutlined","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.3250e2ff.chunk.js","sourcesContent":["export type TextStyleType = 'auto' | 'custom';\r\nexport type TextStyle = typeof defaultTextStyle;\r\nexport const defaultTextStyle = {\r\n    fillStyle: '#000000',\r\n    shadowColor: '#000000',\r\n    shadowOffsetY: 0,\r\n    shadowOffsetX: 0,\r\n    shadowBlur: 0,\r\n    hasShadow: false,\r\n};\r\n\r\nexport type Card = typeof defaultCard;\r\nexport const defaultCard = {\r\n    frame: 'fusion',\r\n    foil: 'normal',\r\n    name: 'Junko',\r\n    nameStyleType: 'auto' as TextStyleType,\r\n    nameStyle: {\r\n        fillStyle: '#000000',\r\n        shadowColor: '#000000',\r\n        shadowOffsetY: 0,\r\n        shadowOffsetX: 0,\r\n        shadowBlur: 0,\r\n        hasShadow: false,\r\n    } as TextStyle,\r\n    attribute: 'LIGHT',\r\n    subFamily: 'NO ICON',\r\n    star: 6,\r\n    picture: 'https://i.imgur.com/h5kXZeC.png',\r\n    pictureCrop: {\r\n        x: 0,\r\n        y: 12,\r\n        width: 269,\r\n        height: 269,\r\n        unit: 'px',\r\n        aspect: 1,\r\n    } as Partial<ReactCrop.Crop>,\r\n    link_map: ['1', '3', '7', '9'] as string[],\r\n    isPendulum: false,\r\n    pendulum_effect: 'Once per turn: You can pay 800 LP, increase this card\\'s Pendulum Scale by 1.',\r\n    red_scale: '4',\r\n    blue_scale: '4',\r\n    type_ability: ['Fairy', 'Fusion', 'Effect'] as string[],\r\n    effect: `[2+ Effect Monsters]\r\nEach time an opponent's monster activates its effect, place 1 Pure Counter on that opponent's monster (max. 1) after that effect resolves. Unaffected by activated effects from monster with a Pure Counter. Cannot be destroyed by battle with monsters with a Pure Counter.`,\r\n    set_id: 'YGOC-EN001',\r\n    atk: '2000',\r\n    def: '2000',\r\n    passcode: '18111996',\r\n    sticker: 'holo5',\r\n    isFirstEdition: true,\r\n    creator: '2020 Studio Dice/SHUEISHA TV TOKYO, KONAMI',\r\n};\r\n\r\nexport const frameType = [\r\n    { name: 'normal', labelColor: '#fff', labelBackgroundColor: '#c49c5e' },\r\n    { name: 'effect', labelColor: '#fff', labelBackgroundColor: '#b96c49' },\r\n    { name: 'fusion', labelColor: '#fff', labelBackgroundColor: '#8948a4' },\r\n    { name: 'synchro', labelColor: '#000', labelBackgroundColor: '#efefef' },\r\n    { name: 'xyz', labelColor: '#fff', labelBackgroundColor: '#000' },\r\n    { name: 'link', labelColor: '#fff', labelBackgroundColor: '#0c8ac6' },\r\n    { name: 'ritual', labelColor: '#fff', labelBackgroundColor: '#5e85c9' },\r\n    { name: 'spell', labelColor: '#fff', labelBackgroundColor: '#1b8f83' },\r\n    { name: 'trap', labelColor: '#fff', labelBackgroundColor: '#c32a8c' },\r\n    { name: 'token', labelColor: '#fff', labelBackgroundColor: '#6f6c6b' },\r\n];\r\n\r\nexport const iconList = [\r\n    'NO ICON',\r\n    'FIELD',\r\n    'CONTINUOUS',\r\n    'QUICK-PLAY',\r\n    'RITUAL',\r\n    'COUNTER',\r\n];\r\n\r\nexport const foilStyleMap: Record<string, TextStyle> = {\r\n    gold: {\r\n        fillStyle: '#b88c43',\r\n        shadowColor: '#FCC400',\r\n        shadowOffsetY: 1,\r\n        shadowOffsetX: 0,\r\n        shadowBlur: 1,\r\n        hasShadow: true,\r\n    },\r\n    platinum: {\r\n        fillStyle: '#CCCCCC',\r\n        shadowColor: '#FFFFFF',\r\n        shadowOffsetY: 1,\r\n        shadowOffsetX: 0,\r\n        shadowBlur: 1,\r\n        hasShadow: true,\r\n    },\r\n};\r\nexport const foilList = [\r\n    { name: 'normal', color: '#747b95', textStyle: defaultTextStyle },\r\n    { name: 'gold', color: '#cfa65f' },\r\n    { name: 'platinum', color: '#b1b1b1' },\r\n];\r\n\r\nexport const stickerList = [\r\n    'no-sticker',\r\n    'gold',\r\n    'silver',\r\n    'beta',\r\n    'holo5',\r\n    'holo4',\r\n    'holo3',\r\n    'holo2',\r\n    'holo1',\r\n];\r\n\r\nexport const attributeList = [\r\n    { name: 'DARK', color: '#b41dda' },\r\n    { name: 'EARTH', color: '#8d8e8e' },\r\n    { name: 'FIRE', color: '#e51b23' },\r\n    { name: 'LIGHT', color: '#bfae32' },\r\n    { name: 'WATER', color: '#008ecd' },\r\n    { name: 'WIND', color: '#28ab35' },\r\n    { name: 'DIVINE', color: '#ef6300' },\r\n    { name: 'SPELL', color: '#1b8f83' },\r\n    { name: 'TRAP', color: '#c32a8c' },\r\n];","import { Card, frameType } from '../model';\r\n\r\nexport const checkNormal = (card: Pick<Card, 'frame'>) => {\r\n    return card.frame === 'normal' && checkMonster(card);\r\n};\r\nexport const checkXyz = (card: Pick<Card, 'frame'>) => {\r\n    return card.frame === 'xyz';\r\n};\r\nexport const checkLink = (card: Pick<Card, 'frame' | 'type_ability'>) => {\r\n    return card.frame === 'link' && checkMonster(card);\r\n};\r\nexport const checkMonster = (card: Pick<Card, 'frame'>) => {\r\n    return card.frame !== 'spell' && card.frame !== 'trap';\r\n};\r\n\r\nexport const getCardFrame = (frame: string) => {\r\n    return frameType.find(entry => entry.name === frame.toLowerCase())?.name ?? 'effect';\r\n};","// @ts-nocheck\r\n/* eslint-disable */\r\n// JSONCrush by Frank Force [MIT] https://github.com/KilledByAPixel/JSONCrush\r\n\"use strict\"\r\nexport const JSONCrush=(e,n=50)=>{for(var r=[],o=127;--o;)(48<=o&&57>=o||65<=o&&90>=o||97<=o&&122>=o||\"-_.!~*'()\".includes(String.fromCharCode(o)))&&r.push(String.fromCharCode(o));for(o=32;255>o;++o){var t=String.fromCharCode(o);\"\\\\\"==t||r.includes(t)||r.unshift(t)}e=e.replace(/\\u0001/g,\"\"),e=JSONCrushSwap(e),o=r.length,t=\"\";for(var i={},l=2;l<n;l++)for(var f=0;f<e.length-l;++f){var h=e.substr(f,l);if(!i[h]){var a=h.charCodeAt(0),g=h.charCodeAt(h.length-1);if(!(a=56320<=a&&57343>=a||55296<=g&&56319>=g)){for(a=1,g=e.indexOf(h,f+l);0<=g;++a)g=e.indexOf(h,g+l);1<a&&(i[h]=a)}}}for(;;){for(;o--&&e.includes(r[o]););if(0>o)break;n=r[o];var d=void 0;l=0,f=encodeURI(encodeURIComponent(n)).replace(/%../g,\"i\").length;for(let e in i)h=((h=i[e])-1)*encodeURI(encodeURIComponent(e)).replace(/%../g,\"i\").length-(h+1)*f,t.length||(h-=encodeURI(encodeURIComponent(\"\u0001\")).replace(/%../g,\"i\").length),0>=h?delete i[e]:h>l&&(d=e,l=h);if(!d)break;e=e.split(d).join(n)+n+d,t=n+t,l={};for(let r in i){for(i=r.split(d).join(n),f=0,h=e.indexOf(i);0<=h;++f)h=e.indexOf(i,h+i.length);1<f&&(l[i]=f)}i=l}return d=e,(r=t).length&&(d+=\"\u0001\"+r),encodeURIComponent(d+\"_\")},JSONUncrush=e=>{var n=(e=e.substring(0,e.length-1)).split(\"\u0001\");if(e=n[0],1<n.length){n=n[1];for(let r of n)e=(e=e.split(r)).join(e.pop())}return JSONCrushSwap(e,0)},JSONCrushSwap=(e,n=1)=>{const r=[['\"',\"'\"],[\"':\",\"!\"],[\",'\",\"~\"],[\"}\",\")\",\"\\\\\",\"\\\\\"],[\"{\",\"(\",\"\\\\\",\"\\\\\"]],o=(e,n)=>e.replace(new RegExp(`${(n[2]?n[2]:\"\")+n[0]}|${(n[3]?n[3]:\"\")+n[1]}`,\"g\"),e=>e===n[0]?n[1]:n[0]);if(n)for(n=0;n<r.length;++n)e=o(e,r[n]);else for(n=r.length;n--;)e=o(e,r[n]);return e}","import { JSONCrush, JSONUncrush } from '../3rd';\r\n\r\nexport const createCondenser = (minThreshold = 0, maxThreshold = 1000) => {\r\n    let min = minThreshold;\r\n    let max = maxThreshold;\r\n    let median = max;\r\n    let lastEffective = median;\r\n    let iterateCount = 30;\r\n    let magnitude = 100;\r\n\r\n    const reverseSearch = () => {\r\n        if (magnitude === 1) finish();\r\n        else {\r\n            median += magnitude;\r\n            magnitude /= 10;\r\n            median -= magnitude;\r\n        }\r\n\r\n        return Math.min(median, max);\r\n    };\r\n\r\n    const searchDown = () => {\r\n        median -= magnitude;\r\n        iterateCount -= 1;\r\n\r\n        return median;\r\n    };\r\n\r\n    const reset = (minThreshold = min, maxThreshold = max) => {\r\n        min = minThreshold;\r\n        max = maxThreshold;\r\n        median = maxThreshold;\r\n        iterateCount = 30;\r\n        magnitude = 100;\r\n        lastEffective = maxThreshold;\r\n    };\r\n\r\n    const getMedian = () => median;\r\n    const setMedian = (newMedian: number) => median = newMedian;\r\n\t\r\n    const setLastEffective = (forceMedian = median) => lastEffective = forceMedian;\r\n    const getLastEffective = () => lastEffective;\r\n    const applyLastEffective = () => {\r\n        median = lastEffective;\r\n        iterateCount = -1;\r\n        return median;\r\n    };\r\n\t\r\n    const getIterateCount = () => iterateCount;\r\n    const finish = () => iterateCount = -1;\r\n\r\n    return {\r\n        reset,\r\n        searchDown,\r\n        reverseSearch,\r\n        finish,\r\n        getMedian,\r\n        setMedian,\r\n        setLastEffective,\r\n        getLastEffective,\r\n        applyLastEffective,\r\n        getIterateCount,\r\n    };\r\n};\r\n\r\nconst cardFieldShortenMap: Record<string, string | Record<string, string>> = {\r\n    frame: 'fr',\r\n    foil: 'fo',\r\n    name: 'na',\r\n    nameStyleType: 'nst',\r\n    nameStyle: {\r\n        _newKey: 'ns',\r\n        fillStyle: 'nsfs',\r\n        shadowColor: 'nssc',\r\n        shadowOffsetY: 'nssoy',\r\n        shadowOffsetX: 'nssox',\r\n        shadowBlur: 'nssb',\r\n        hasShadow: 'nshs',\r\n    },\r\n    attribute: 'at',\r\n    subFamily: 'sf',\r\n    star: 'st',\r\n    picture: 'pt',\r\n    pictureCrop: {\r\n        _newKey: 'ptc',\r\n        x: 'ptx',\r\n        y: 'pty',\r\n        width: 'ptw',\r\n        height: 'pth',\r\n        unit: 'ptu',\r\n        aspect: 'pta',\r\n    },\r\n    link_map: 'lm',\r\n    isPendulum: 'ip',\r\n    pendulum_effect: 'pe',\r\n    red_scale: 'rs',\r\n    blue_scale: 'bs',\r\n    type_ability: 'ta',\r\n    effect: 'ef',\r\n    set_id: 'si',\r\n    atk: 'atk',\r\n    def: 'def',\r\n    passcode: 'pc',\r\n    sticker: 'sti',\r\n    isFirstEdition: 'ife',\r\n    creator: 'cr',\r\n};\r\nexport const cardDataCondenser = (\r\n    card: Record<string, any>,\r\n    shortenMap: Record<string, any> = cardFieldShortenMap,\r\n    crush = true,\r\n) => {\r\n    const condensedCard: Record<string, any> = {};\r\n    Object.keys(card).forEach(cardKey => {\r\n        const cardValue = card[cardKey];\r\n\r\n        if (typeof cardValue === 'object' && cardValue !== null && !Array.isArray(cardValue)) {\r\n            const newKey = shortenMap[cardKey]?._newKey;\r\n\r\n            if (newKey) {\r\n                condensedCard[newKey] = cardDataCondenser(cardValue, shortenMap[cardKey], false);\r\n            }\r\n        } else {\r\n            const newKey = shortenMap[cardKey];\r\n\r\n            if (typeof newKey === 'string') condensedCard[newKey] = cardValue;\r\n        }\r\n    });\r\n\r\n    if (crush) {\r\n        const curshedCard = JSONCrush(JSON.stringify(condensedCard));\r\n\r\n        return curshedCard;\r\n    }\r\n    return condensedCard;\r\n};\r\nexport const reverseCardDataCondenser = (\r\n    condensedCard: Record<string, any> | string,\r\n    shortenMap: Record<string, any> = cardFieldShortenMap,\r\n) => {\r\n    const normalizedCondensedCard = typeof condensedCard === 'string'\r\n        ? JSON.parse(JSONUncrush(decodeURIComponent(condensedCard)))\r\n        : condensedCard;\r\n\r\n    const fullCard: Record<string, any> = {};\r\n    Object.keys(shortenMap).forEach(fullKey => {\r\n        const shortendValue = shortenMap[fullKey];\r\n\r\n        if (typeof shortendValue === 'object' && shortendValue !== null && !Array.isArray(shortendValue)) {\r\n            const shortendKey = shortendValue?._newKey;\r\n\r\n            if (shortendKey && normalizedCondensedCard[shortendKey]) {\r\n                fullCard[fullKey] = reverseCardDataCondenser(normalizedCondensedCard[shortendKey], shortenMap[fullKey]);\r\n            }\r\n        } else {\r\n            if (normalizedCondensedCard[shortendValue]) {\r\n                fullCard[fullKey] = normalizedCondensedCard[shortendValue];\r\n            }\r\n        }\r\n    });\r\n    return fullCard;\r\n};","export const randomCharacter = (charSet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', length = 1) => {\r\n    let result           = '';\r\n    const charactersLength = charSet.length;\r\n    for ( let i = 0; i < length; i++) {\r\n        result += charSet.charAt(Math.floor(Math.random() * charactersLength));\r\n    }\r\n    return result;\r\n};\r\n\r\nexport const randomSetID = () => {\r\n    return `${randomCharacter('ABCDEFGHIJKLMNOPQRSTUVWXYZ', 4)}-EN${randomCharacter('0123456789', 3)}`;\r\n};\r\n\r\nexport const randomPassword = () => {\r\n    return `${randomCharacter('0123456789', 8)}`;\r\n};\r\n\r\nexport const splitEffect = (effect: string, isNormal = false) => {\r\n    let effectBody = effect;\r\n\r\n    let effectMaterial = '';\r\n    const materialRegex = /^(\\[([^\\]]*)\\]\\s*)/m;\r\n    const materialReplacement = materialRegex.exec(effectBody)?.[1];\r\n    const material = materialRegex.exec(effectBody)?.[2];\r\n    if (material && materialReplacement) {\r\n        effectMaterial = material;\r\n        effectBody = effectBody.replace(materialReplacement, '');\r\n    } else effectMaterial = '';\r\n\r\n    let effectFlavorCondition = '';\r\n    const flavorConditionRegex = /(\\n^[\\r\\t\\f\\v \\u00a0\\u1680\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000\\ufeff]*\\([\\w\\W]+\\))\\s*$/m;\r\n    const flavorCondition = flavorConditionRegex.exec(effect)?.[1];\r\n    if (flavorCondition && isNormal) {\r\n        effectFlavorCondition = flavorCondition;\r\n        effectBody = effectBody.replace(flavorCondition, '');\r\n    } else effectFlavorCondition = '';\r\n\r\n    return {\r\n        material: effectMaterial,\r\n        body: effectBody,\r\n        flavorCondition: effectFlavorCondition\r\n    };\r\n};\r\n\r\nexport const quoteConvert = (text?: string) => {\r\n    let normalizedString = (text ?? '');\r\n    normalizedString = normalizedString.replace(/(^|[-\\u2014\\s([\"])'/g, '$1\\u2018')\r\n        .replace(/'/g, '\\u2019')\r\n        .replace(/(^|[-\\u2014/[(\\u2018\\s])\"/g, '$1\\u201c')\r\n        .replace(/\"/g, '\\u201d')\r\n        .replace(/--/g, '\\u2014');\r\n    return normalizedString;\r\n};\r\n\r\nexport function insertUrlParam(key: string, value: string) {\r\n    if (window.history.pushState) {\r\n        let searchParams = new URLSearchParams(window.location.search);\r\n        searchParams.set(key, value);\r\n        let newurl = window.location.protocol + '//' + window.location.host + window.location.pathname + '?' + searchParams.toString();\r\n        window.history.pushState({path: newurl}, '', newurl);\r\n    }\r\n}\r\n\r\nexport * from './categorize';\r\nexport * from './condenser';","import { Spin } from 'antd';\r\nimport './loading.scss';\r\n\r\nexport const Loading = () => {\r\n    return <Spin />;\r\n};\r\nLoading.FullView = () => {\r\n    return <div className=\"loading-fullview\">\r\n        <Spin size=\"large\" />\r\n    </div>;\r\n};","import { Button, Input, Radio } from 'antd';\r\nimport React, { useState, useCallback, useRef, useEffect, useImperativeHandle } from 'react';\r\nimport ReactCrop from 'react-image-crop';\r\nimport 'react-image-crop/dist/ReactCrop.css';\r\nimport { Loading } from '../loading';\r\nimport './card-picture.scss';\r\n\r\nfunction generateDownload(canvas: HTMLCanvasElement | null, crop: ReactCrop.Crop | null) {\r\n    if (!crop || !canvas) return;\r\n    canvas.toBlob(\r\n        (blob) => {\r\n            const previewUrl = window.URL.createObjectURL(blob);\r\n\r\n            const anchor = document.createElement('a');\r\n            anchor.download = 'cropPreview.png';\r\n            anchor.href = URL.createObjectURL(blob);\r\n            anchor.click();\r\n\r\n            window.URL.revokeObjectURL(previewUrl);\r\n        },\r\n        'image/png',\r\n        1\r\n    );\r\n}\r\n\r\nexport type ImageCropperRef = {\r\n    forceExternalSource: (pictureLink: string, cropInfo: Partial<ReactCrop.Crop>) => void,\r\n}\r\nexport type ImageCropper = {\r\n    noRedrawNumber?: number,\r\n\tdefaultExternalSource?: string,\r\n    previewCanvasRef?: HTMLCanvasElement | null,\r\n    children?: React.ReactNode,\r\n    ratio?: number,\r\n    defaultCropInfo: Partial<ReactCrop.Crop>,\r\n    onSourceChange?: (source: string) => void,\r\n    onImageChange?: (cropInfo: Partial<ReactCrop.Crop>, sourceType: 'internal' | 'external') => void,\r\n    onTainted: () => void,\r\n}\r\nexport const ImageCropper = React.forwardRef<ImageCropperRef, ImageCropper>(({\r\n    noRedrawNumber = 0,\r\n    defaultExternalSource = '',\r\n    previewCanvasRef,\r\n    children,\r\n    ratio = 1,\r\n    defaultCropInfo,\r\n    onSourceChange = () => {},\r\n    onImageChange = () => {},\r\n    onTainted = () => {},\r\n}: ImageCropper, forwardedRef) => {\r\n    const [crossorigin, setCrossOrigin] = useState<'anonymous' | 'use-credentials' | undefined>('anonymous');\r\n    const [sourceType, setSourceType] = useState<'internal' | 'external'>('external');\r\n    const [internalSource, setInternalSource] = useState('');\r\n    const [isLoading, setLoading] = useState(false);\r\n    const [externalSource, setExternalSource] = useState(defaultExternalSource);\r\n    const imgRef = useRef<HTMLImageElement | null>(null);\r\n    const [crop, setCrop] = useState<ReactCrop.Crop>(defaultCropInfo);\r\n    const [completedCrop, setCompletedCrop] = useState<ReactCrop.Crop | null>(null);\r\n\r\n    const onSelectFile = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        if (e.target.files && e.target.files.length > 0) {\r\n            setLoading(true);\r\n            const reader = new FileReader();\r\n            reader.addEventListener('load', () => {\r\n                if (typeof reader.result === 'string') {\r\n                    setInternalSource(reader.result);\r\n                    setSourceType('internal');\r\n                }\r\n            });\r\n            reader.readAsDataURL(e.target.files[0]);\r\n        }\r\n    };\r\n\r\n    const onLoad = useCallback((img: HTMLImageElement) => {\r\n        setLoading(false);\r\n        imgRef.current = img;\r\n    }, []);\r\n\t\r\n    const onExternalSourceChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const source = e.target.value;\r\n\r\n        setLoading(true);\r\n        setSourceType('external');\r\n        onSourceChange(source);\r\n        setExternalSource(source);\r\n    };\r\n\r\n    useEffect(() => {\r\n        const image = imgRef.current;\r\n        const canvas = previewCanvasRef;\r\n        const crop = completedCrop;\r\n        if (!crop || !canvas || !image) return;\r\n\r\n        const ctx = canvas.getContext('2d');\r\n        if (!ctx) return;\r\n\r\n        const scaleX = image.naturalWidth / image.width;\r\n        const scaleY = image.naturalHeight / image.height;\r\n        const pixelRatio = window.devicePixelRatio;\r\n        const boundingWidth = Math.ceil(canvas.getBoundingClientRect().width);\r\n        const boundingHeight = Math.ceil(canvas.getBoundingClientRect().height);\r\n\r\n        canvas.width = (boundingWidth ?? 0) * pixelRatio;\r\n        canvas.height = (boundingHeight ?? 0) * pixelRatio;\r\n\r\n        ctx.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\r\n        ctx.imageSmoothingQuality = 'high';\r\n\r\n        ctx.drawImage(\r\n            image,\r\n            (crop.x ?? 0) * scaleX,\r\n            (crop.y ?? 0) * scaleY,\r\n            (crop.width ?? 0) * scaleX,\r\n            (crop.height ?? 0) * scaleY,\r\n            0,\r\n            0,\r\n            (boundingWidth ?? 0),\r\n            (boundingHeight ?? 0)\r\n        );\r\n        onImageChange(crop, sourceType);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [completedCrop, previewCanvasRef, noRedrawNumber]);\r\n\r\n    useImperativeHandle(forwardedRef, () => ({\r\n        forceExternalSource: (source, cropInfo) => {\r\n            setLoading(true);\r\n            setSourceType('external');\r\n            onSourceChange(source);\r\n            setExternalSource(source);\r\n            setCrop(cropInfo);\r\n        }\r\n    }));\r\n\r\n    return (\r\n        <div className=\"card-image-cropper\">\r\n            <div className=\"card-image-source-input\">\r\n                {children}\r\n                <Radio.Group onChange={e => setSourceType(e.target.value)} value={sourceType}>\r\n                    <Radio.Button value={'external'}>\r\n                        <Input key=\"key\"\r\n                            addonBefore=\"Link\" placeholder=\"https://my-online-image...\"\r\n                            value={externalSource}\r\n                            onChange={onExternalSourceChange} maxLength={256} />\r\n                    </Radio.Button>\r\n                    <Radio.Button value={'internal'}>\r\n                        <Input type=\"file\"  accept=\"image/*\" onChange={onSelectFile} />\r\n                        <div>\r\n                            {sourceType === 'internal' && <>\r\n                                <Button\r\n                                    className=\"download-button\"\r\n                                    disabled={!completedCrop?.width || !completedCrop?.height}\r\n                                    onClick={() => previewCanvasRef && generateDownload(previewCanvasRef, completedCrop)}\r\n                                >\r\n                                Download cropped image#3b9dff\r\n                                </Button>\r\n                                <span style={{ color: '#FF6F6F' }}>Offline images are not auto saved!</span>\r\n                            </>}\r\n                        </div>\r\n                    </Radio.Button>\r\n                </Radio.Group>\r\n            </div>\r\n            <div className=\"card-cropper\">\r\n                {isLoading && <Loading.FullView />}\r\n                <ReactCrop key={sourceType}\r\n                    src={sourceType === 'internal' ? internalSource : externalSource}\r\n                    onImageLoaded={onLoad}\r\n                    onImageError={() => {\r\n                        onTainted();\r\n                        setCrossOrigin(undefined);\r\n                    }}\r\n                    crop={crop}\r\n                    onChange={cropData => setCrop({ ...cropData, aspect: ratio })}\r\n                    onComplete={cropData => setCompletedCrop(cropData)}\r\n                    ruleOfThirds={true}\r\n                    crossorigin={crossorigin}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n","import { Tooltip } from 'antd';\r\nimport { useEffect, useState } from 'react';\r\nimport './link-marker.scss';\r\n\r\nexport type LinkMarkChooser = {\r\n    defaultValue?: string[],\r\n    onChange?: (value: string[]) => void,\r\n};\r\nexport const LinkMarkChooser = ({\r\n    defaultValue = [],\r\n    onChange = () => {},\r\n}: LinkMarkChooser) => {\r\n    const [choosenArrow, setChoosenArrow] = useState(defaultValue);\r\n    const rotateMap = [-45, 0, 45, -90, 0, 90, -135, 180, 135];\r\n\r\n    const literalChoosenArrow = JSON.stringify(choosenArrow);\r\n    useEffect(() => {\r\n        onChange(choosenArrow);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [literalChoosenArrow]);\r\n\r\n    return <div className=\"link-marker-chooser\">\r\n        <div className=\"title\">\r\n            Link Arrows\r\n        </div>\r\n        <div className=\"container\">\r\n            {[...Array(9)].map((entry, index) => {\r\n                const normalizedIndex = `${index + 1}`;\r\n\r\n                if (normalizedIndex === '5') return <Tooltip key=\"5\" overlay=\"Reset\">\r\n                    <div className=\"link-marker-reset\" onClick={() => {\r\n                        setChoosenArrow([]);\r\n                    }}>R</div>\r\n                </Tooltip>;\r\n\r\n                return <div key={normalizedIndex}\r\n                    className={`link-marker-button marker-${index + 1} ${choosenArrow.includes(normalizedIndex) ? 'marker-checked' : ''}`}\r\n                    onClick={() => {\r\n                        setChoosenArrow(cur => {\r\n                            let newMap = [...cur];\r\n\r\n                            if (newMap.includes(normalizedIndex)) newMap = newMap.filter(entry => entry !== normalizedIndex);\r\n                            else newMap.push(normalizedIndex);\r\n\r\n                            return newMap;\r\n                        });\r\n                    }}\r\n                >\r\n                    <div className={`link-marker-icon link-marker-icon-${index + 1}`} style={{ transform: `rotate(${rotateMap[index]}deg)` }} />\r\n                </div>;\r\n            })}\r\n        </div>\r\n    </div>;\r\n};","import { frameType, iconList, attributeList, stickerList, foilList } from '../../model';\r\nimport './input-panel.scss';\r\n\r\nexport const foilButton = foilList.map(({ color, name }) => ({\r\n    label: name.toLocaleUpperCase(),\r\n    value: name,\r\n    props: {\r\n        style: {\r\n            color,\r\n            fontWeight: 'bold',\r\n        } as React.CSSProperties,\r\n    }\r\n}));\r\nexport const frameButton = frameType.map(({ labelColor, name, labelBackgroundColor }) => ({\r\n    label: name,\r\n    value: name,\r\n    props: {\r\n        style: {\r\n            backgroundColor: labelBackgroundColor,\r\n            color: labelColor,\r\n        } as React.CSSProperties,\r\n    }\r\n}));\r\nexport const attributeButton = attributeList.map(({ name }) => ({\r\n    label: <img alt={name} src={`${process.env.PUBLIC_URL}/asset/image/attribute/attr-${name.toLowerCase()}.png`} />,\r\n    value: name,\r\n}));\r\nexport const iconButton = iconList.map(entry => ({\r\n    label: entry,\r\n    value: entry,\r\n}));\r\nexport const starButton = [...Array(14)].map((e, index) => ({ label: index, value: index }));\r\nexport const stickerButton = stickerList.map(name => ({\r\n    label: name === 'no-sticker'\r\n        ? <span>NONE</span>\r\n        : <img alt={name} src={`${process.env.PUBLIC_URL}/asset/image/sticker/sticker-${name.toLowerCase()}.png`} />,\r\n    value: name,\r\n}));","import { useCallback, useEffect, useState } from 'react';\r\nimport Moveable from 'react-moveable';\r\nimport { EllipsisOutlined } from '@ant-design/icons';\r\nimport './char-picker.scss';\r\n\r\nfunction insertAtCursor(myField: HTMLTextAreaElement, myValue: string) {\r\n    //IE support\r\n    if ((document as any).selection) {\r\n        myField.focus();\r\n        const sel = (document as any).selection.createRange();\r\n        sel.text = myValue;\r\n\r\n        return {\r\n            value: myField.value,\r\n            position: 0,\r\n        };\r\n    }\r\n    //MOZILLA and others\r\n    else if (myField.selectionStart || myField.selectionStart === 0) {\r\n        const startPos = myField.selectionStart;\r\n        const endPos = myField.selectionEnd;\r\n        myField.value = myField.value.substring(0, startPos)\r\n            + myValue\r\n            + myField.value.substring(endPos, myField.value.length);\r\n        myField.selectionStart = startPos + myValue.length;\r\n        myField.selectionEnd = startPos + myValue.length;\r\n        myField.focus();\r\n\r\n        return {\r\n            value: myField.value,\r\n            position: startPos + myValue.length,\r\n        };\r\n    } else {\r\n        myField.value += myValue;\r\n\r\n        return {\r\n            value: myField.value,\r\n            position: 0,\r\n        };\r\n    }\r\n}\r\n\r\nexport type CharPicker = {\r\n    targetId: string,\r\n    onPick?: (value: string) => void,\r\n}\r\nexport const CharPicker = ({\r\n    targetId = '',\r\n    onPick = () => {},\r\n}: CharPicker) => {\r\n    const [target, setTarget] = useState<HTMLElement | null>(null);\r\n    const internalOnPick = (char: string) => {\r\n        const inputTarget = document.getElementById(targetId) as HTMLTextAreaElement;\r\n        if (inputTarget) {\r\n            const { value } = insertAtCursor(inputTarget, char);\r\n\r\n            onPick(value);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        setTarget(document.getElementById('char-picker'));\r\n    }, []);\r\n\r\n    const onDrag = useCallback(({\r\n        target,\r\n        left, top,\r\n        transform,\r\n    }) => {\r\n        target!.style.left = `${left}px`;\r\n        target!.style.top = `${top}px`;\r\n        target!.style.transform = transform;\r\n    }, []);\r\n\r\n    return <div className=\"char-picker-container\">\r\n        {<div id={'char-picker'} className=\"char-picker\">\r\n            <div className=\"handler\">\r\n                <EllipsisOutlined />\r\n            </div>\r\n            {[\r\n                '',\r\n                '',\r\n                '',\r\n                '',\r\n                '',\r\n                '',\r\n            ].map(entry => {\r\n                return <button key={entry} className=\"ant-btn\" onClick={() => internalOnPick(entry)}>{entry}</button>;\r\n            })}\r\n        </div>}\r\n        <Moveable\r\n            target={target}\r\n            container={null}\r\n\r\n            /* Resize event edges */\r\n            edge={false}\r\n\r\n            /* draggable */\r\n            draggable={true}\r\n            throttleDrag={0}\r\n            onDrag={onDrag}\r\n        />\r\n    </div>;\r\n};","import { Checkbox, InputNumber, Popover, Slider } from 'antd';\r\nimport React, { useRef, useState } from 'react';\r\nimport { CompactPicker } from 'react-color';\r\nimport { CaretUpOutlined, CaretDownOutlined } from '@ant-design/icons';\r\nimport { TextStyle, TextStyleType } from '../../../model';\r\nimport PowerSlider from 'react-input-slider';\r\nimport { debounce } from 'lodash';\r\nimport './style-picker.scss';\r\n\r\nexport type StylePicker = {\r\n    defaultType: TextStyleType,\r\n\tdefaultValue: TextStyle,\r\n\tonChange: (type: TextStyleType, style: TextStyle) => void,\r\n}\r\nexport const StylePicker = React.memo(({\r\n    defaultType,\r\n    defaultValue,\r\n    onChange: undebouncedOnChange,\r\n}: StylePicker) => {\r\n    const [type, setType] = useState(defaultType);\r\n    const [value, setValue] = useState(defaultValue);\r\n    const [isColorPickerVisble, setColorPickerVisible] = useState(false);\r\n    const [isShadowPickerVisble, setShadowPickerVisible] = useState(false);\r\n    const onChange = useRef(debounce(undebouncedOnChange, 250)).current;\r\n\r\n    const setCustomValue = <ValueType extends any>(key: keyof TextStyle) => {\r\n        return (inputValue: ValueType) => {\r\n            setValue(curValue => {\r\n                const newStyle = { ...curValue, [key]: inputValue };\r\n\r\n                onChange('custom', newStyle);\r\n                return newStyle;\r\n            });\r\n        };\r\n    };\r\n\r\n    return <div className=\"ant-input-group-wrapper name-color-input\">\r\n        <span className=\"ant-input-wrapper ant-input-group\">\r\n            <span className=\"ant-input-group-addon\">Name Color</span>\r\n            <span className=\"ant-input-affix-wrapper\">\r\n                <div className=\"ant-radio-group ant-radio-group-outline\">\r\n                    <label className={`ant-radio-wrapper ${type === 'auto' ? 'ant-radio-wrapper-checked' : ''}`} onClick={() => {\r\n                        setType('auto');\r\n                        onChange('auto', value);\r\n                    }}>\r\n                        <span className={`ant-radio ${type === 'auto' ? 'ant-radio-checked' : ''}`}>\r\n                            <input type=\"radio\" className=\"ant-radio-input\" value=\"auto\" />\r\n                            <span className=\"ant-radio-inner\" />\r\n                        </span>\r\n                        <span>Auto</span>\r\n                    </label>\r\n                    <label className={`ant-radio-wrapper ${type === 'custom' ? 'ant-radio-wrapper-checked' : ''}`} onClick={() => {\r\n                        setType('custom');\r\n                        onChange('custom', value);\r\n                    }}>\r\n                        <span className={`ant-radio ${type === 'custom' ? 'ant-radio-checked' : ''}`}>\r\n                            <input type=\"radio\" className=\"ant-radio-input\" value=\"custom\" />\r\n                            <span className=\"ant-radio-inner\" />\r\n                        </span>\r\n                        <div className=\"style-picker\">\r\n                            Custom\r\n                            <Popover key=\"color-picker\"\r\n                                overlayClassName=\"input-overlay style-picker-overlay\"\r\n                                content={<>\r\n                                    <div className=\"style-picker-mask\" onClick={() => setColorPickerVisible(false)} />\r\n                                    <div className={'custom-style-picker'}>\r\n                                        <div className=\"custom-style-text\">\r\n                                            <h2>Text Color</h2>\r\n                                            <CompactPicker color={value.fillStyle} onChange={color => {\r\n                                                setType('custom');\r\n                                                setValue(cur => {\r\n                                                    const newStyle = { ...cur, fillStyle: color.hex };\r\n\r\n                                                    onChange('custom', newStyle);\r\n                                                    return newStyle;\r\n                                                });\r\n                                            }} />\r\n                                        </div>\r\n                                    </div>\r\n                                </>}\r\n                                visible={isColorPickerVisble}\r\n                                placement=\"bottom\"\r\n                            >\r\n                                <div className=\"picker-dropdown color-picker-dropdown\" onClick={() => setColorPickerVisible(cur => !cur)}>\r\n                                    Change Color {isColorPickerVisble ? <CaretUpOutlined /> : <CaretDownOutlined />}\r\n                                </div>\r\n                            </Popover>\r\n                            <Popover key=\"shadow-picker\"\r\n                                overlayClassName=\"input-overlay style-picker-overlay\"\r\n                                content={<>\r\n                                    <div className=\"style-picker-mask\" onClick={() => setShadowPickerVisible(false)} />\r\n                                    <div className={'custom-style-picker'}>\r\n                                        <h3 className=\"custom-style-expand\">\r\n                                            <Checkbox value={'has-shadow'} checked={value.hasShadow} onChange={() => {\r\n                                                setType('custom');\r\n                                                setValue(cur => {\r\n                                                    const newStyle = { ...cur, hasShadow: !cur.hasShadow };\r\n                    \r\n                                                    onChange('custom', newStyle);\r\n                                                    return newStyle;\r\n                                                });\r\n                                            }}>Has Shadow?</Checkbox>\r\n                                        </h3>\r\n                                        {value.hasShadow && <div className=\"custom-style-shadow\">\r\n                                            <h2>Position</h2>\r\n                                            <div className=\"shadow-position\">\r\n                                                <PowerSlider axis=\"xy\"\r\n                                                    styles={{\r\n                                                        track: {\r\n                                                            backgroundColor: '#009ce0',\r\n                                                            width: 100,\r\n                                                            height: 100,\r\n                                                            gridRow: 'span 3',\r\n                                                            position: 'relative',\r\n                                                        },\r\n                                                        thumb: {\r\n                                                            backgroundColor: '#91d5ff',\r\n                                                            zIndex: 10,\r\n                                                        },\r\n                                                    }}\r\n                                                    xmax={5} xmin={-5}\r\n                                                    ymax={5} ymin={-5}\r\n                                                    x={value.shadowOffsetX}\r\n                                                    y={value.shadowOffsetY}\r\n                                                    onChange={({ x, y }) => {\r\n                                                        setValue(cur => {\r\n                                                            const newStyle = { ...cur,\r\n                                                                ...cur,\r\n                                                                shadowOffsetX: x,\r\n                                                                shadowOffsetY: y,\r\n                                                            };\r\n\r\n                                                            onChange('custom', newStyle);\r\n                                                            return newStyle;\r\n                                                        });\r\n                                                    }} />\r\n                                                <div className=\"single-slider\">\r\n                                                    X Offset: <InputNumber size=\"small\" value={value.shadowOffsetX} onChange={setCustomValue('shadowOffsetX')} />\r\n                                                </div>\r\n                                                <div className=\"single-slider\">\r\n                                                    Y Offset: <InputNumber size=\"small\" value={value.shadowOffsetY} onChange={setCustomValue('shadowOffsetY')} />\r\n                                                </div>\r\n                                                <div className=\"single-slider\">\r\n                                                    Blur: <Slider value={value.shadowBlur} min={0} max={10} onChange={(value: number) => {\r\n                                                        if (typeof value === 'number') setValue(cur => {\r\n                                                            const newStyle = { ...cur, shadowBlur: value };\r\n\r\n                                                            onChange('custom', newStyle);\r\n                                                            return newStyle;\r\n                                                        });\r\n                                                    }} />\r\n                                                </div>\r\n                                                <div />\r\n                                            </div>\r\n                                            <h2>Color</h2>\r\n                                            <CompactPicker color={value.shadowColor} onChange={color => {\r\n                                                setValue(cur => {\r\n                                                    const newStyle = { ...cur, shadowColor: color.hex };\r\n\r\n                                                    onChange('custom', newStyle);\r\n                                                    return newStyle;\r\n                                                });\r\n                                            }} />\r\n                                        </div>}\r\n                                    </div>\r\n                                </>}\r\n                                visible={isShadowPickerVisble}\r\n                                placement=\"bottom\"\r\n                            >\r\n                                <div className=\"picker-dropdown shadow-picker-dropdown\" onClick={() => setShadowPickerVisible(cur => !cur)}>\r\n                                    Change Shadow {isShadowPickerVisble ? <CaretUpOutlined /> : <CaretDownOutlined />}\r\n                                </div>\r\n                            </Popover>\r\n                        </div>\r\n                    </label>\r\n                </div>\r\n            </span>\r\n        </span>\r\n    </div>;\r\n}, () => true);\r\n","import React from 'react';\r\n\r\n\r\n\r\nexport type CheckboxTrain = {\r\n\tclassName?: string,\r\n\tvalue: string,\r\n\toptionList: { label: React.ReactNode, value: string | number, props?: React.LabelHTMLAttributes<HTMLLabelElement> }[],\r\n\tonChange: (value: string | number) => void,\r\n\tchildren?: React.ReactNode,\r\n}\r\nexport const CheckboxTrain = ({\r\n    onChange,\r\n    value,\r\n    optionList,\r\n    children,\r\n    className,\r\n}: CheckboxTrain) => {\r\n    const combinedClass = ['ant-radio-group ant-radio-group-outline checkbox-train', className].join(' ');\r\n\r\n    return <div className={combinedClass}>\r\n        {children && <label className=\"standalone-addon ant-input-group-addon\">{children}</label>}\r\n        {optionList.map(entry => {\r\n            const isChecked = `${entry.value}` === `${value}`;\r\n\r\n            return <label key={entry.value}\r\n                {...entry.props}\r\n                className={`ant-radio-button-wrapper ${isChecked ? 'ant-radio-button-wrapper-checked' : ''}`}\r\n                onClick={() => {\r\n                    onChange(entry.value);\r\n                }}\r\n            >\r\n                <span className={`ant-radio-button ${isChecked ? 'ant-radio-button-checked' : ''}`}>\r\n                    <span className=\"ant-radio-button-inner\"></span>\r\n                </span>\r\n                <span>{entry.label}</span>\r\n            </label>;\r\n        })}\r\n    </div>;\r\n};","import React, { useImperativeHandle, useRef, useState } from 'react';\r\nimport { Input, Checkbox, Tooltip } from 'antd';\r\nimport { Card, TextStyle, TextStyleType } from '../../model';\r\nimport { ImageCropper, LinkMarkChooser } from '../../component';\r\nimport { checkXyz, checkLink, checkMonster, randomPassword, randomSetID } from '../../util';\r\nimport { debounce } from 'lodash';\r\nimport { SyncOutlined } from '@ant-design/icons';\r\nimport { foilButton, frameButton, starButton, iconButton, attributeButton, stickerButton } from './const';\r\nimport { CharPicker } from './char-picker';\r\nimport { StylePicker } from './style-picker';\r\nimport { CheckboxTrain } from './input-train';\r\nimport { ImageCropperRef } from '../../component/card-picture';\r\nimport './input-panel.scss';\r\n\r\nconst { TextArea } = Input;\r\n\r\nconst onChangeFactory = (\r\n    key: string,\r\n    mutateFunction: (func: (card: Card) => Card) => void,\r\n    valueTransform: (value: any) => any = (value) => value,\r\n) => {\r\n    return (e: any) => {\r\n        mutateFunction(current => ({\r\n            ...current,\r\n            [key]: valueTransform(typeof e === 'string' || typeof e === 'number' || Array.isArray(e) ? e : e?.target?.value),\r\n        }));\r\n    };\r\n};\r\n\r\ntype RandomButton = {\r\n    seeder: () => string,\r\n    onGenerate: (value: string) => void,\r\n}\r\nconst RandomButton = ({\r\n    seeder,\r\n    onGenerate,\r\n}: RandomButton) => {\r\n    return <span style={{ marginLeft: 10, paddingLeft: 10, borderLeft: '1px solid #222' }}>\r\n        <Tooltip overlay=\"Randomize\">\r\n            <SyncOutlined onClick={() => onGenerate(seeder())} />\r\n        </Tooltip>\r\n    </span>;\r\n};\r\n\r\nexport type CardInputPanelRef = {\r\n    forceCardData: (card: Card) => void,\r\n}\r\nexport type CardInputPanel = {\r\n\tcurrentCard: Card,\r\n    receivingCanvasRef: HTMLCanvasElement | null,\r\n    defaultCropInfo: Partial<ReactCrop.Crop>,\r\n\tonCardChange: React.Dispatch<React.SetStateAction<Card>>,\r\n    onImageChange?: (cropInfo: Partial<ReactCrop.Crop>, sourceType: 'internal' | 'external') => void,\r\n    children?: React.ReactNode,\r\n} & {\r\n    onTainted: ImageCropper['onTainted']\r\n}\r\nexport const CardInputPanel = React.forwardRef<CardInputPanelRef, CardInputPanel>(({\r\n    currentCard,\r\n    receivingCanvasRef,\r\n    defaultCropInfo,\r\n    onCardChange,\r\n    onImageChange,\r\n    onTainted,\r\n    children,\r\n}: CardInputPanel, forwardedRef) => {\r\n    const [isMirrorScale, setMirrorScale] = useState(true);\r\n    const imageCropperRef = useRef<ImageCropperRef>(null);\r\n    const setCard = (mutateFunc: (card: Card) => Card) => {\r\n        onCardChange(currentCard => mutateFunc(currentCard));\r\n    };\r\n    const onFoilChange = onChangeFactory('foil', setCard);\r\n    const onFrameChange = (frameValue: number | string) => {\r\n        onCardChange(currentCard => {\r\n            const value = `${frameValue}`;\r\n            const isST = value === 'spell' || value === 'trap';\r\n            const newTypeAbility = value === 'spell'\r\n                ? ['Spell Card']\r\n                : value === 'trap' ? ['Trap Card'] : currentCard.type_ability;\r\n            if (isST) setDisplayTypeAbility(newTypeAbility[0]);\r\n    \r\n            return {\r\n                ...currentCard,\r\n                frame: value,\r\n                isPendulum: value === 'link' || value === 'token' || isST ? false : currentCard.isPendulum,\r\n                subFamily: isST ? 'NO ICON' : currentCard.subFamily,\r\n                attribute: isST\r\n                    ? `${value}`.toUpperCase()\r\n                    : currentCard.attribute,\r\n                type_ability: value === 'spell'\r\n                    ? ['Spell Card']\r\n                    : value === 'trap' ? ['Trap Card'] : currentCard.type_ability,\r\n            };\r\n        });\r\n    };\r\n    const onAttributeChange = onChangeFactory('attribute', setCard);\r\n    const onSubFamilyChange = onChangeFactory('subFamily', setCard);\r\n    const onNameChange = debounce(onChangeFactory('name', setCard), 350);\r\n    const onNameColorChange = (type: TextStyleType, value: TextStyle) => {\r\n        onCardChange(currentCard => {\r\n            return {\r\n                ...currentCard,\r\n                nameStyleType: type,\r\n                nameStyle: value,\r\n            };\r\n        });\r\n    };\r\n    const onStarChange = onChangeFactory('star', setCard);\r\n    const onIsPendulumChange = (e: any) => onCardChange(currentCard => {\r\n        return { ...currentCard, isPendulum: e.target.checked };\r\n    });\r\n    const onPictureChange = onChangeFactory('picture', setCard);\r\n    const onLinkMapChange = onChangeFactory('link_map', setCard);\r\n    const onRedScaleChange = onChangeFactory('red_scale', setCard);\r\n    const onBlueScaleChange = onChangeFactory('blue_scale', setCard);\r\n    const onPendulumEffectChange = debounce(onChangeFactory('pendulum_effect', setCard), 350);\r\n    const onEffectChange = debounce(onChangeFactory('effect', setCard), 350);\r\n    const onATKChange = onChangeFactory('atk', setCard);\r\n    const onDEFChange = onChangeFactory('def', setCard);\r\n    const onTypeAbilityChange = debounce((value: (string | number)[]) => {\r\n        setCard(current => ({\r\n            ...current,\r\n            type_ability: value.map(entry => `${entry}`),\r\n        }));\r\n    }, 350);\r\n    const onSetIDChange = onChangeFactory('set_id', setCard);\r\n    const onPasscodeChange = onChangeFactory('passcode', setCard);\r\n    const onStickerChange = onChangeFactory('sticker', setCard);\r\n    const onCreatorChange = onChangeFactory('creator', setCard);\r\n    const onFirstEditionChange = (e: any) => onCardChange(currentCard => {\r\n        return { ...currentCard, isFirstEdition: e.target.checked };\r\n    });\r\n\r\n    const {\r\n        frame, foil,\r\n        name, nameStyleType, nameStyle,\r\n        picture,\r\n        effect,\r\n        type_ability,\r\n        isPendulum, pendulum_effect, red_scale, blue_scale,\r\n        atk, def, link_map,\r\n        attribute,\r\n        subFamily,\r\n        star,\r\n        set_id,\r\n        passcode, isFirstEdition, creator, sticker,\r\n    } = currentCard;\r\n    const isXyz = checkXyz(currentCard);\r\n    const isLink = checkLink(currentCard);\r\n    const isMonster = checkMonster(currentCard);\r\n    const [displayTypeAbility, setDisplayTypeAbility] = useState(type_ability.join('/'));\r\n    const [displayName, setDisplayName] = useState(name);\r\n    const [displayEffect, setDisplayEffect] = useState(effect);\r\n    const [displayPendulumEffect, setDisplayPendulumEffect] = useState(pendulum_effect);\r\n    const [onlineCharPicker, setOnlineCharPicker] = useState('');\r\n    const ref = useRef();\r\n    \r\n    useImperativeHandle(forwardedRef, () => ({\r\n        forceCardData: (card) => {\r\n            setDisplayTypeAbility(card.type_ability.join('/'));\r\n            setDisplayName(card.name);\r\n            setDisplayEffect(card.effect);\r\n            setDisplayPendulumEffect(card.pendulum_effect);\r\n            imageCropperRef.current?.forceExternalSource(card.picture, card.pictureCrop);\r\n        }\r\n    }));\r\n\r\n    return <div className=\"card-info-panel\">\r\n        {children}\r\n        <CharPicker\r\n            targetId={onlineCharPicker}\r\n            onPick={value => {\r\n                if (ref.current) (ref.current as any)?.props?.onChange?.({\r\n                    target: { value }\r\n                });\r\n            }}\r\n        />\r\n        <CheckboxTrain className=\"foil-radio\" value={foil} onChange={onFoilChange} optionList={foilButton}>\r\n            <span>Foil</span>\r\n        </CheckboxTrain>\r\n        <CheckboxTrain className=\"frame-radio\" value={frame} onChange={onFrameChange} optionList={frameButton} />\r\n        <hr />\r\n        <div className=\"card-header custom-gap\">\r\n            <Input\r\n                id=\"name\"\r\n                ref={onlineCharPicker === 'name' ? ref as any : null}\r\n                onFocus={() => setOnlineCharPicker('name')}\r\n                allowClear\r\n                addonBefore={'Name'}\r\n                placeholder=\"Card Name\"\r\n                value={displayName}\r\n                className=\"name-input\"\r\n                onChange={ev => {\r\n                    onNameChange(ev);\r\n                    setDisplayName(ev.target.value);\r\n                }}\r\n            />\r\n            <StylePicker defaultType={nameStyleType} defaultValue={nameStyle} onChange={onNameColorChange} />\r\n            {isMonster\r\n                ? !isLink\r\n                    ? <CheckboxTrain className=\"checkbox-star-train\" value={`${star}`} onChange={onStarChange} optionList={starButton}>\r\n                        <span>{isXyz ? 'Rank' : 'Level'}</span>\r\n                    </CheckboxTrain>\r\n                    : null\r\n                : <CheckboxTrain value={subFamily} onChange={onSubFamilyChange} optionList={iconButton}>\r\n                    <span>Icon</span>\r\n                </CheckboxTrain>\r\n            }\r\n            <CheckboxTrain className=\"checkbox-image-train\" value={attribute} onChange={onAttributeChange} optionList={attributeButton}>\r\n                <span>Attribute</span>\r\n            </CheckboxTrain>\r\n        </div>\r\n        <div key=\"pic\" className=\"main-info\">\r\n            <div className=\"main-info-first\">\r\n                <Input\r\n                    id=\"set-id\"\r\n                    ref={onlineCharPicker === 'set-id' ? ref as any : null}\r\n                    onFocus={() => setOnlineCharPicker('set-id')}\r\n                    allowClear\r\n                    className=\"set-id-input\"\r\n                    addonBefore={<>Set ID<RandomButton seeder={randomSetID} onGenerate={onSetIDChange} /></>}\r\n                    onChange={onSetIDChange}\r\n                    placeholder=\"Set ID\"\r\n                    value={set_id}\r\n                />\r\n                {(isMonster && frame !== 'link' && frame !== 'token') && <div className=\"pendulum-container\">\r\n                    <div className=\"joined-row\">\r\n                        <Checkbox onChange={onIsPendulumChange} checked={isPendulum}>Is Pendulum?</Checkbox>\r\n                        {isPendulum && <Checkbox onChange={e => setMirrorScale(e.target.checked)} checked={isMirrorScale}>Mirror Scale?</Checkbox>}\r\n                    </div>\r\n                    {isPendulum && <>\r\n                        <div>\r\n                            <Input key=\"blue-scale\" addonBefore={<span>\r\n                                <span style={{ color: '#3b9dff' }}>Blue</span> Scale\r\n                            </span>}\r\n                            value={blue_scale}\r\n                            onChange={e => {\r\n                                onBlueScaleChange(e);\r\n                                if (isMirrorScale) onRedScaleChange(e);\r\n                            }} />\r\n                        </div>\r\n                        <div>\r\n                            <Input key=\"red-scale\" addonBefore={<span>\r\n                                <span style={{ color: '#ff6f6f' }}>Red</span> Scale\r\n                            </span>}\r\n                            value={red_scale}\r\n                            onChange={e => {\r\n                                if (isMirrorScale) onBlueScaleChange(e);\r\n                                onRedScaleChange(e);\r\n                            }} />\r\n                        </div>\r\n                        <div className=\"joined-row\" style={{ position: 'relative' }}>\r\n                            <TextArea key=\"pendulum-effect\"\r\n                                id=\"pendulum-effect\"\r\n                                ref={onlineCharPicker === 'pendulum-effect' ? ref as any : null}\r\n                                onFocus={() => setOnlineCharPicker('pendulum-effect')}\r\n                                allowClear\r\n                                placeholder=\"Pendulum effect\"\r\n                                value={displayPendulumEffect}\r\n                                onChange={ev => {\r\n                                    onPendulumEffectChange(ev);\r\n                                    setDisplayPendulumEffect(ev.target.value);\r\n                                }}\r\n                                rows={6}\r\n                            />\r\n                        </div>\r\n                    </>}\r\n                </div>}\r\n                <Input addonBefore=\"Type\"\r\n                    id=\"type\"\r\n                    ref={onlineCharPicker === 'type' ? ref as any : null}\r\n                    onFocus={() => setOnlineCharPicker('type')}\r\n                    allowClear\r\n                    onChange={ev => {\r\n                        const value = ev.target.value;\r\n\r\n                        setDisplayTypeAbility(value);\r\n                        onTypeAbilityChange(value\r\n                            .split('/')\r\n                            .map(entry => entry.trim())\r\n                            .filter(entry => typeof entry === 'string' && entry.length > 0));\r\n                    }}\r\n                    placeholder=\"Type / Ability\"\r\n                    style={{ width: '100%' }}\r\n                    value={displayTypeAbility}\r\n                />\r\n                <TextArea key=\"effect\"\r\n                    id=\"card-effect\"\r\n                    ref={onlineCharPicker === 'card-effect' ? ref as any : null}\r\n                    onFocus={() => setOnlineCharPicker('card-effect')}\r\n                    allowClear\r\n                    placeholder=\"Card effect\"\r\n                    value={displayEffect}\r\n                    rows={10}\r\n                    onChange={ev => {\r\n                        onEffectChange(ev);\r\n                        setDisplayEffect(ev.target.value);\r\n                    }}\r\n                />\r\n                <div className=\"card-footer-input\">\r\n                    {isMonster\r\n                        ? <Input key=\"atk\"\r\n                            id=\"atk\"\r\n                            ref={onlineCharPicker === 'atk' ? ref as any : null}\r\n                            onFocus={() => setOnlineCharPicker('atk')}\r\n                            addonBefore=\"ATK\" allowClear value={atk} onChange={onATKChange} />\r\n                        : <div />}\r\n                    {isMonster\r\n                        ? <Input key=\"def\"\r\n                            id=\"def\"\r\n                            ref={onlineCharPicker === 'def' ? ref as any : null}\r\n                            onFocus={() => setOnlineCharPicker('def')}\r\n                            addonBefore=\"DEF\" allowClear value={def} onChange={onDEFChange} />\r\n                        : <div />\r\n                    }\r\n                    <Input\r\n                        id=\"password\"\r\n                        ref={onlineCharPicker === 'password' ? ref as any : null}\r\n                        onFocus={() => setOnlineCharPicker('password')}\r\n                        allowClear\r\n                        className=\"password-input\"\r\n                        addonBefore={<>Password<RandomButton seeder={randomPassword} onGenerate={onPasscodeChange} /></>}\r\n                        onChange={onPasscodeChange}\r\n                        placeholder=\"Password\"\r\n                        value={passcode}\r\n                    />\r\n                    <Checkbox\r\n                        className=\"input-1st\"\r\n                        onChange={onFirstEditionChange}\r\n                        checked={isFirstEdition}\r\n                    >\r\n                        Is 1st Edition?\r\n                    </Checkbox>\r\n                    <Input addonBefore=\"Creator\"\r\n                        id=\"creator\"\r\n                        ref={onlineCharPicker === 'creator' ? ref as any : null}\r\n                        onFocus={() => setOnlineCharPicker('creator')}\r\n                        allowClear\r\n                        className=\"creator-input\"\r\n                        onChange={onCreatorChange}\r\n                        placeholder=\"Creator\"\r\n                        value={creator}\r\n                    />\r\n                    <CheckboxTrain className=\"sticker-input checkbox-image-train\" value={sticker} onChange={onStickerChange} optionList={stickerButton}>\r\n                        <span>Sticker</span>\r\n                    </CheckboxTrain>\r\n                </div>\r\n            </div>\r\n            <div className=\"main-info-second\">\r\n                <ImageCropper\r\n                    ref={imageCropperRef}\r\n                    noRedrawNumber={1}\r\n                    defaultExternalSource={picture}\r\n                    defaultCropInfo={defaultCropInfo}\r\n                    previewCanvasRef={receivingCanvasRef}\r\n                    onSourceChange={onPictureChange}\r\n                    onImageChange={onImageChange}\r\n                    onTainted={onTainted}\r\n                >\r\n                    {isLink\r\n                        ? <LinkMarkChooser defaultValue={link_map} onChange={onLinkMapChange} />\r\n                        : <div />}\r\n                </ImageCropper>\r\n            </div>\r\n        </div>\r\n    </div>;\r\n});","import React from 'react';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport { Popover } from 'antd';\r\nimport './app-header.scss';\r\n\r\nexport const AppHeader = React.memo(() => {\r\n    return <div className=\"app-header\">\r\n        <img alt=\"app-logo\" src={`${process.env.PUBLIC_URL}/logo192.png`} width={48} />\r\n        <div className=\"app-description\">\r\n            <h1>Yugioh Carder <small style={{ fontFamily: 'serif' }}>v{process.env.REACT_APP_VERSION ?? 'unknown'} TCG</small></h1>\r\n            <div className=\"app-contribution\">\r\n                <span>GUI: <b>Lauqerm</b></span>\r\n                <span>Template: <b>Grezar</b> and others (<a\r\n                    href=\"https://www.deviantart.com/grezar/art/SKILL-UPDATE-Series-10-Card-Proxy-Template-686736691\"\r\n                    target=\"_blank\"\r\n                    rel=\"noreferrer\">Deviant Art</a>)</span>\r\n                <Popover overlayClassName=\"disclaimer-overlay\" content={<div className=\"disclaimer\">\r\n                    <h2>Disclaimer</h2>\r\n                    <ul>\r\n                        <li>This is a personal project, not an \"official\" card maker.</li>\r\n                        <li>I holds no liability for cards created by this app, including picture, card text and any product that related to it.</li>\r\n                        <li>I do not own any of Yu-Gi-Oh card layers and fonts use in this project.</li>\r\n                        <li>If you want to modify card layers, or use it in any public project, please contact <a\r\n                            href=\"https://www.deviantart.com/grezar\"\r\n                            target=\"_blank\"\r\n                            rel=\"noreferrer\">Grezar</a> directly.</li>\r\n                    </ul>\r\n                </div>}>\r\n                    <ExclamationCircleOutlined className=\"disclaimer-icon\" />\r\n                </Popover>\r\n            </div>\r\n        </div>\r\n    </div>;\r\n}, () => true);\r\n\r\nexport const taintedCanvasWarning = <Popover\r\n    overlayClassName=\"disclaimer-overlay\"\r\n    style={{ display: 'inline-block' }}\r\n    content={<div className=\"disclaimer\">\r\n        <h2>What is a tainted canvas?</h2>\r\n        <p>\r\n        You are using an image host that does not get the \"approval\" needed to be draw to the app. Browsers see it as a potential security risk (even if it is not the case), and mark the canvas as \"tainted\".\r\n        </p>\r\n        <h2>How does it affect me?</h2>\r\n        <p>\r\n        A \"tainted canvas\" prevent all sort of automatic save. From then on you must save the card manually by right click it  \"Save image as...\". It is implying that this action is fully as your concern.<br />\r\n        Furthemore, once it get tainted, it will remains tainted even if you switch to other \"safe\" image host.\r\n        </p>\r\n        <h2>How do I fix it?</h2>\r\n        <p>\r\n        Change to other host (\"imgur\" for example, Facebook and Twitter will also work just fine) THEN refresh the page.<br />\r\n        If you cannot afford to do that, the app will also work mostly just fine, you only need to manually save the card (and keep cautious).\r\n        </p>\r\n    </div>}>\r\n    <ExclamationCircleOutlined className=\"disclaimer-icon\" />\r\n</Popover>;","export type FontSize = {\r\n    fontSize: number,\r\n    lineHeight: number,\r\n    lineCount: number,\r\n};\r\nexport type BoxSize = {\r\n\twidth: number,\r\n\ttop: number,\r\n\tleft: number,\r\n};\r\n\r\nexport const monsterFontList: FontSize[] = [\r\n    { fontSize: 17, lineHeight: 17, lineCount: 6 },\r\n    { fontSize: 14, lineHeight: 14, lineCount: 7 },\r\n    { fontSize: 12, lineHeight: 12, lineCount: 8 },\r\n    { fontSize: 11, lineHeight: 11, lineCount: 9 },\r\n    { fontSize: 10, lineHeight: 10, lineCount: 10 },\r\n    { fontSize: 9, lineHeight: 9, lineCount: 11 },\r\n    { fontSize: 8, lineHeight: 8, lineCount: 12 },\r\n];\r\nexport const monsterSizeList: BoxSize[] = [\r\n    { width: 463, top: 620, left: 43.89 },\r\n    { width: 463, top: 624, left: 43.89 },\r\n    { width: 463, top: 624, left: 43.89 },\r\n    { width: 463, top: 624, left: 43.89 },\r\n    { width: 463, top: 624, left: 43.89 },\r\n    { width: 463, top: 624, left: 43.89 },\r\n    { width: 463, top: 624, left: 43.89 },\r\n];\r\nexport const monsterVanillaFontList: FontSize[] = [\r\n    { fontSize: 16.74, lineHeight: 17.01, lineCount: 6 },\r\n    { fontSize: 16.74, lineHeight: 17.01, lineCount: 7 },\r\n    { fontSize: 16.74, lineHeight: 17.01, lineCount: 8 },\r\n];\r\n\r\nexport const pendulumFontList: FontSize[] = [\r\n    { fontSize: 16.41, lineHeight: 16.44, lineCount: 5 },\r\n    { fontSize: 16.41, lineHeight: 16.44, lineCount: 5 },\r\n];\r\nexport const pendulumSizeList: BoxSize[] = [\r\n    { width: 375, top: 504.5, left: 87.05 },\r\n    { width: 375, top: 504.5, left: 87.05 },\r\n];\r\n\r\nexport const stFontList: FontSize[] = [\r\n    { fontSize: 16.41, lineHeight: 16.74, lineCount: 8 },\r\n    { fontSize: 13.46, lineHeight: 14.28, lineCount: 10 },\r\n];\r\nexport const stSizeList: BoxSize[] = [\r\n    { width: 461, top: 601, left: 45 },\r\n    { width: 461, top: 601, left: 45 },\r\n];\r\n\r\nexport type TypeSize = {\r\n\ttop: number,\r\n\tleft: number,\r\n    bracketSize: {\r\n        char: number,\r\n        bracketSpace: number,\r\n        bracketOffsetTop: number,\r\n    },\r\n    upperCaseSize: number,\r\n    upperCaseScale: number,\r\n    lowerCaseSize: number,\r\n    lowerCaseScale: number,\r\n    spaceScale: number,\r\n    spaceSize: {\r\n        frontSpace: number,\r\n        char: number,\r\n        behindSpace: number,\r\n    },\r\n    iconSpace: number,\r\n};\r\nexport const typeSizeMap: Record<string, TypeSize> = {\r\n    small: {\r\n        top: 622,\r\n        left: 43,\r\n        bracketSize: {\r\n            char: 18.71,\r\n            bracketSpace: 8.51,\r\n            bracketOffsetTop: 1.64,\r\n        },\r\n        upperCaseSize: 20,\r\n        upperCaseScale: 1,\r\n        lowerCaseSize: 16,\r\n        lowerCaseScale: 1.1,\r\n        spaceScale: 1,\r\n        spaceSize: {\r\n            frontSpace: 5,\r\n            char: 21,\r\n            behindSpace: 15,\r\n        },\r\n        iconSpace: 0,\r\n    },\r\n    medium: {\r\n        top: 620.80,\r\n        left: 43,\r\n        bracketSize: {\r\n            char: 19.69,\r\n            bracketSpace: 8.51,\r\n            bracketOffsetTop: 1.64,\r\n        },\r\n        upperCaseSize: 21,\r\n        upperCaseScale: 1,\r\n        lowerCaseSize: 18,\r\n        lowerCaseScale: 0.95,\r\n        spaceScale: 1,\r\n        spaceSize: {\r\n            frontSpace: 5,\r\n            char: 23,\r\n            behindSpace: 15,\r\n        },\r\n        iconSpace: 0,\r\n    },\r\n    large: {\r\n        top: 126,\r\n        left: 494,\r\n        bracketSize: {\r\n            char: 25,\r\n            bracketSpace: 11,\r\n            bracketOffsetTop: 2,\r\n        },\r\n        upperCaseSize: 26,\r\n        upperCaseScale: 1.1,\r\n        lowerCaseSize: 23,\r\n        lowerCaseScale: 1,\r\n        spaceScale: 1.4,\r\n        spaceSize: {\r\n            frontSpace: 5,\r\n            char: 23,\r\n            behindSpace: 15,\r\n        },\r\n        iconSpace: 32,\r\n    },\r\n};","export const arrowPositionList = [\r\n    { top: 126, left: 46, width: 50, height: 51 },\r\n    { top: 116, left: 226, width: 99, height: 32 },\r\n    { top: 126, left: 453, width: 51, height: 51 },\r\n    { top: 305, left: 35, width: 33, height: 99 },\r\n    { top: 0, left: 0, width: 0, height: 0 },   // Middle\r\n    { top: 305, left: 482, width: 32, height: 99 },\r\n    { top: 534, left: 46, width: 50, height: 50 },\r\n    { top: 562, left: 226, width: 99, height: 33 },\r\n    { top: 534, left: 453, width: 51, height: 50 },\r\n];\r\n\r\nexport const foilPosition: Record<string, {\r\n    art: { left: number }\r\n}> = {\r\n    gold: {\r\n        art: {\r\n            left: 2,\r\n        }\r\n    },\r\n    platinum: {\r\n        art: {\r\n            left: 1,\r\n        }\r\n    },\r\n};","import { FontSize, monsterFontList, BoxSize, monsterSizeList } from '../const';\r\nimport { defaultTextStyle, TextStyle } from '../model';\r\nimport { splitEffect, createCondenser, quoteConvert } from '../util';\r\n\r\nexport const drawName = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    value: string,\r\n    edge: number,\r\n    baseline: number,\r\n    maxWidth: number,\r\n    style: TextStyle,\r\n) => {\r\n    if (ctx && value) {\r\n        ctx.fillStyle = style.fillStyle;\r\n        if (style.hasShadow) {\r\n            ctx.shadowColor = style.shadowColor;\r\n            ctx.shadowOffsetY = style.shadowOffsetY;\r\n            ctx.shadowOffsetX = style.shadowOffsetX;\r\n            ctx.shadowBlur = style.shadowBlur;\r\n        }\r\n        const splittedText = quoteConvert(value).split(/([^&A-Za-z0-9\\-/\\s()])/g);\r\n        const contentWidth = splittedText\r\n            .reduce((prev, cur, index) => {\r\n                if (index % 2 === 0) ctx.font = '64.59px MatrixRegularSmallCaps';\r\n                else ctx.font = '54.59px matrix';\r\n\r\n                return prev + ctx.measureText(cur).width;\r\n            }, 0);\r\n\r\n        // ctx.fillText(value, edge, baseline, maxWidth);\r\n        if (contentWidth > 0) {\r\n            const condenseRatio = Math.min(maxWidth / contentWidth, 1);\r\n            ctx.scale(condenseRatio, 1);\r\n            splittedText\r\n                .reduce((prev, cur, index) => {\r\n                    if (index % 2 === 0) ctx.font = '64.59px MatrixRegularSmallCaps';\r\n                    else ctx.font = 'small-caps 54.59px matrix';\r\n    \r\n                    ctx.fillText(cur, prev / condenseRatio, baseline);\r\n                    return prev + ctx.measureText(cur).width * condenseRatio;\r\n                }, edge);\r\n            ctx.scale(1 / condenseRatio, 1);\r\n        }\r\n        ctx.fillStyle = defaultTextStyle.fillStyle;\r\n        ctx.shadowColor = defaultTextStyle.shadowColor;\r\n        ctx.shadowOffsetY = defaultTextStyle.shadowOffsetY;\r\n        ctx.shadowOffsetX = defaultTextStyle.shadowOffsetX;\r\n        ctx.shadowBlur = defaultTextStyle.shadowBlur;\r\n    }\r\n};\r\n\r\nexport const drawScale = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    value: string,\r\n    edge: number,\r\n    baseline: number,\r\n) => {\r\n    if (ctx && value) {\r\n        const digitList = `${value}`.split('');\r\n        let totalWidth = 0;\r\n\r\n        digitList.forEach(digit => {\r\n            totalWidth += (digit === '1' ? ctx.measureText(digit).width * 0.65 : ctx.measureText(digit).width);\r\n        });\r\n        let accLeft = edge - totalWidth / 2;\r\n\r\n        digitList.forEach(digit => {\r\n            ctx.fillText(digit, digit === '1' ? accLeft - 3 : accLeft, baseline);\r\n            accLeft += (digit === '1' ? ctx.measureText(digit).width * 0.65 : ctx.measureText(digit).width);\r\n        });\r\n    }\r\n};\r\n\r\nexport const drawEffect = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    content: string,\r\n    isPendulumEffect = false,\r\n    isNormal = false,\r\n    fontList: FontSize[] = monsterFontList,\r\n    sizeList: BoxSize[] = monsterSizeList,\r\n) => {\r\n    const normalizedContent = quoteConvert(content);\r\n    let effectIndexSize = 0;\r\n    if (ctx && content) {\r\n        const tolerantPerSentence: Record<string, number> = {\r\n            '1': 645,\r\n            '2': 665,\r\n            '3': 685,\r\n        };\r\n        const {\r\n            body: effectBody,\r\n            flavorCondition: effectFlavorCondition,\r\n            material: effectMaterial,\r\n        } = isPendulumEffect\r\n            ? {\r\n                body: normalizedContent,\r\n                flavorCondition: '',\r\n                material: '',\r\n            } : splitEffect(normalizedContent, isNormal);\r\n\r\n        const additionalLineCount = (effectMaterial.length > 0 ? 1 : 0) + (effectFlavorCondition.length > 0 ? 1 : 0);\r\n        const sentencizeText = effectBody.split('\\n');\r\n        const bulletSymbol = '';\r\n        const bulletSymbolWidth = 15;\r\n        const specialSymbol = '#@';\r\n        const breakableSymbol = '\\\\s-';\r\n        \r\n        const tokenizeR = new RegExp(`([${specialSymbol}${breakableSymbol}])`, 'g');\r\n        const specialSymbolReg = new RegExp(specialSymbol, 'g');\r\n\r\n        while(effectIndexSize < fontList.length) {\r\n            const { fontSize, lineHeight, lineCount } = fontList[effectIndexSize];\r\n            const { left, width: basedWidth, top } = sizeList[effectIndexSize];\r\n            const width = isNormal ? basedWidth - 2 : basedWidth;\r\n            const condenser = createCondenser();\r\n            let effectiveRatio = 1000;\r\n\r\n            const maxLine = Math.max(sentencizeText.length, lineCount);\r\n\r\n            ctx.font = `${isNormal ? 'italic' : ''} ${fontSize}px MatrixBook`;\r\n            ctx.textAlign = 'left';\r\n\r\n            const switchFont = (func: () => void) => {\r\n                const tempFont = ctx.font;\r\n                const largeSize = fontSize * 1.15;\r\n                ctx.font = tempFont.replace('MatrixBook', 'matrix').replace(`${fontSize}`, `${largeSize}`);\r\n                func();\r\n                ctx.font = tempFont;\r\n            };\r\n\r\n            // [CREATE SENTENCE ON EACH LINE]\r\n            let lineList: { text: string, width: number, isLast: boolean }[] = [];\r\n            const createSentence = () => {\r\n                lineList = [];\r\n\r\n                return sentencizeText.reduce((prev, curr) => {\r\n                    // The width is \"expand\" based on condense ratio so all the calculate does not need to be scaled\r\n                    const condenseRatio = condenser.getMedian() / 1000;\r\n                    const hypoWidth = width / condenseRatio;\r\n                    const tokenizedText = curr.split(tokenizeR);\r\n                    let currentLineCount = 1;\r\n                    let tokenSentence: string[] = [];\r\n                    let totalWidth = 0;\r\n\r\n                    for (let cnt = 0; cnt < tokenizedText.length; cnt++) {\r\n                        let tokenWidth = 0;\r\n                        /**\r\n                         * If bullet symbol is met, it will become \"wider\" based on condense ratio\r\n                         * so that when the whole line is condense, bullet symbol's width become\r\n                         * \"normal\", as if it were not condensed\r\n                         */\r\n                        if (tokenizedText[cnt] === bulletSymbol) tokenWidth = bulletSymbolWidth / condenseRatio;\r\n                        /**\r\n                         * Some special symbol required different font\r\n                         */\r\n                        else if (specialSymbolReg.test(tokenizedText[cnt])) {\r\n                            switchFont(() => {\r\n                                tokenWidth = ctx.measureText(tokenizedText[cnt]).width;\r\n                            });\r\n                        } else tokenWidth = ctx.measureText(tokenizedText[cnt]).width;\r\n                        if (totalWidth + tokenWidth > hypoWidth) {\r\n                            // If the next token cause overflow, wrap it down\r\n                            const fullString = tokenSentence.join('').trim();\r\n                            // Calculate the line width as if the bullet is wider\r\n                            const fullStringSplittedByBullet = fullString.split(bulletSymbol);\r\n                            lineList.push({\r\n                                text: fullString,\r\n                                width: fullStringSplittedByBullet.reduce((prev, curr) => prev + ctx.measureText(curr).width, 0)\r\n                                    + (fullStringSplittedByBullet.length - 1) * bulletSymbolWidth / condenseRatio,\r\n                                isLast: false,\r\n                            });\r\n                            totalWidth = tokenWidth;\r\n                            tokenSentence = [tokenizedText[cnt]];\r\n                            currentLineCount += 1;\r\n                        } else {\r\n                            totalWidth += tokenWidth;\r\n                            tokenSentence.push(tokenizedText[cnt]);\r\n                        }\r\n                    }\r\n\r\n                    const fullString = tokenSentence.join('').trim();\r\n                    const fullStringSplittedByBullet = fullString.split(bulletSymbol);\r\n                    lineList.push({\r\n                        text: fullString,\r\n                        width: fullStringSplittedByBullet.reduce((prev, curr) => prev + ctx.measureText(curr).width, 0)\r\n                            + (fullStringSplittedByBullet.length - 1) * bulletSymbolWidth / condenseRatio,\r\n                        isLast: true,\r\n                    });\r\n    \r\n                    return prev + currentLineCount;\r\n                }, 0) + additionalLineCount;\r\n            };\r\n\r\n            // [FIND SUITABLE CONDENSE RATIO]\r\n            while (condenser.getIterateCount() >= 0) {\r\n                if (condenser.getIterateCount() <= 0) {\r\n                    // When out of iteration, return the concluded median\r\n                    effectiveRatio = condenser.getMedian();\r\n                    break;\r\n                } else {\r\n                    const lineCount = createSentence();\r\n\r\n                    if (lineCount > maxLine) {\r\n                        // If overflow, lower the median and apply it\r\n                        condenser.searchDown();\r\n                    } else {\r\n                        if (condenser.getMedian() === 1000) break;\r\n                        else effectiveRatio = condenser.reverseSearch();\r\n                    }\r\n                }\r\n            }\r\n\r\n            // [START DRAWING]\r\n            const drawBullet = (ctx: CanvasRenderingContext2D, edge: number, baseline: number) => {\r\n                ctx.beginPath();\r\n                ctx.arc(edge + 7, baseline - 5.5, 5.5, 0, 2 * Math.PI, false);\r\n                ctx.fill();\r\n                ctx.lineWidth = 1;\r\n                ctx.strokeStyle = '#003300';\r\n                ctx.stroke();\r\n            };\r\n            if ((effectiveRatio < (tolerantPerSentence[`${sentencizeText.length}`] ?? tolerantPerSentence['3']))\r\n            && effectIndexSize < fontList.length - 1) {\r\n                effectIndexSize += 1;\r\n            } else {\r\n                ctx?.clearRect(0, 0, 549, 750);\r\n                let baseline = top + lineHeight;\r\n                if (effectMaterial.length > 0) {\r\n                    let actualWidth = ctx.measureText(effectMaterial).width;\r\n                    let condenseRatio = Math.min(width / actualWidth, 1);\r\n\r\n                    ctx.scale(condenseRatio, 1);\r\n                    ctx.fillText(effectMaterial, left / condenseRatio, baseline);\r\n                    baseline += lineHeight;\r\n                    ctx.scale(1 / condenseRatio, 1);\r\n                }\r\n\r\n                const sigmoidRatio = effectiveRatio / 1000; // Fancy way to force ratio in to 0-1 range\r\n                lineList.forEach(({\r\n                    text,\r\n                    width: actualWidth,\r\n                    isLast,\r\n                }) => {\r\n                    const condenseRatio = isLast\r\n                        ? Math.min(sigmoidRatio, 1)\r\n                        : width / actualWidth;\r\n\r\n                    if (condenseRatio <= 1) {\r\n                        ctx.scale(condenseRatio, 1);\r\n                        const splitter = new RegExp(`([${bulletSymbol}${specialSymbol}])`, 'g');\r\n                        const splittedText = text.split(splitter);\r\n\r\n                        splittedText.reduce((prev, cur, index) => {\r\n                            let edge = prev;\r\n\r\n                            // Normal text\r\n                            if (index % 2 === 0) {\r\n                                ctx.fillText(cur, edge / condenseRatio, baseline);\r\n                                edge += ctx.measureText(cur).width * condenseRatio;\r\n                            } else {\r\n                                // Special bullet\r\n                                if (cur === bulletSymbol) {\r\n                                    ctx.scale(1 / condenseRatio, 1);\r\n                                    drawBullet(ctx, edge, baseline);\r\n                                    edge += 15;\r\n                                    ctx.scale(condenseRatio, 1);\r\n                                } else {\r\n                                    switchFont(() => {\r\n                                        ctx.fillText(cur, edge / condenseRatio, baseline);\r\n                                        edge += ctx.measureText(cur).width * condenseRatio;\r\n                                    });\r\n                                }\r\n                            }\r\n\r\n                            return edge;\r\n                        }, left);\r\n                        baseline += lineHeight;\r\n                        ctx.scale(1 / condenseRatio, 1);\r\n                    } else {\r\n                        const splitter = new RegExp(`([${bulletSymbol}${specialSymbol} ])`, 'g');\r\n                        const spaceSeparatedText = text.split(splitter);\r\n                        ctx.scale(1, 1);\r\n                        let nonSpaceWidth = 0;\r\n                        let spaceCount = 0;\r\n\r\n                        spaceSeparatedText.forEach(entry => {\r\n                            if (entry === ' ') spaceCount += 1;\r\n                            else if (entry === bulletSymbol) nonSpaceWidth += 15;\r\n                            else if (specialSymbolReg.test(entry)) {\r\n                                switchFont(() => nonSpaceWidth += ctx.measureText(entry).width);\r\n                            } else nonSpaceWidth += ctx.measureText(entry).width;\r\n                        });\r\n                        // Split text by \"space\", then distribute remaining width to those spaces, resulting in \"widen\" space\r\n                        const spaceWidth = spaceCount > 0 ? (width - nonSpaceWidth) / spaceCount : 0;\r\n\r\n                        spaceSeparatedText.reduce((prev, cur, index) => {\r\n                            let edge = prev;\r\n\r\n                            // Normal text\r\n                            if (index % 2 === 0) {\r\n                                ctx.fillText(cur, edge, baseline);\r\n                                edge += ctx.measureText(cur).width;\r\n                            } else {\r\n                                // Special bullet\r\n                                if (cur === bulletSymbol) {\r\n                                    drawBullet(ctx, edge, baseline);\r\n                                    edge += 15;\r\n                                } else if (cur === ' ') {\r\n                                    edge += spaceWidth;\r\n                                } else {\r\n                                    switchFont(() => {\r\n                                        ctx.fillText(cur, edge, baseline);\r\n                                        edge += ctx.measureText(cur).width;\r\n                                    });\r\n                                }\r\n                            }\r\n\r\n                            return edge;\r\n                        }, left);\r\n                        baseline += lineHeight;\r\n                    }\r\n                });\r\n\r\n                if (effectFlavorCondition.length > 0) {\r\n                    let actualWidth = ctx.measureText(effectFlavorCondition).width;\r\n                    let condenseRatio = Math.min(width / actualWidth, 1);\r\n\r\n                    ctx.font = `${fontSize}px MatrixBook`;\r\n                    ctx.scale(condenseRatio, 1);\r\n                    ctx.fillText(effectFlavorCondition, left / condenseRatio, baseline);\r\n                    baseline += lineHeight;\r\n                    ctx.scale(1 / condenseRatio, 1);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n        return effectIndexSize;\r\n    }\r\n    return effectIndexSize;\r\n};","export const measureWithSymbol = (\r\n    ctx: CanvasRenderingContext2D,\r\n    content: string,\r\n    symbol: string,\r\n    maxWidth: number,\r\n) => {\r\n    const splittedContent = content.split(symbol);\r\n    const splittedWidth = splittedContent.map(entry => ctx.measureText(entry).width);\r\n    const symbolWidth = ctx.measureText(symbol).width;\r\n    const totalCondensableWidth = splittedWidth.reduce((prev, curr) => prev + curr, 0);\r\n    const returnBundle = {\r\n        splittedContent,\r\n        splittedWidth,\r\n        symbolWidth,\r\n        totalCondensableWidth,\r\n        condenseRatio: 1,\r\n    };\r\n\r\n    if (totalCondensableWidth > 0) {\r\n        // Calculate as if the \"symbol\" always appear as full width\r\n        returnBundle.condenseRatio = Math.min((maxWidth - (splittedWidth.length - 1) * symbolWidth) / totalCondensableWidth, 1);\r\n    }\r\n\r\n    return returnBundle;\r\n};\r\n\r\nexport const fillTextLeftWithSpacing = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    str: string,\r\n    letterSpacingRatio: number,\r\n    edge: number,\r\n    baseline: number,\r\n) => {\r\n    if (ctx && str) {\r\n        ctx.textAlign = 'left';\r\n        const charList = str.split('');\r\n        let curLeft = edge;\r\n\r\n        charList.forEach(char => {\r\n            ctx.fillText(char, curLeft, baseline);\r\n            curLeft += ctx.measureText(char).width * (1 + (letterSpacingRatio / 2));\r\n        });\r\n\r\n        return curLeft;\r\n    }\r\n    return 0;\r\n};\r\nexport const fillTextRightWithSpacing = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    str: string,\r\n    letterSpacingRatio: number,\r\n    edge: number,\r\n    baseline: number,\r\n) => {\r\n    if (ctx && str) {\r\n        ctx.textAlign = 'right';\r\n        const charList = str.split('');\r\n        let curRight = edge;\r\n\r\n        charList.forEach((c, index) => {\r\n            const char = charList[charList.length - index - 1];\r\n            ctx.fillText(char, curRight, baseline);\r\n            curRight -= ctx.measureText(char).width * (1 + (letterSpacingRatio / 2));\r\n        });\r\n        return curRight;\r\n    };\r\n    return edge;\r\n};\r\n\r\nexport const fillTextLeftWithLimit = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    content: string,\r\n    edge: number,\r\n    baseline: number,\r\n    maxWidth: number,\r\n) => {\r\n    if (ctx) {\r\n        const contentWidth = ctx.measureText(content).width;\r\n\r\n        if (contentWidth > 0) {\r\n            const condenseRatio = Math.min(maxWidth / contentWidth, 1);\r\n            ctx.scale(condenseRatio, 1);\r\n            ctx.fillText(content, edge / condenseRatio, baseline);\r\n            ctx.scale(1 / condenseRatio, 1);\r\n            ctx.fillStyle = '#000000';\r\n        }\r\n    }\r\n};","import { fillTextRightWithSpacing, measureWithSymbol } from './util';\r\n\r\nexport const draw1stEdition = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    edge = 99,\r\n) => {\r\n    if (ctx) {\r\n        ctx.font = 'bold 16px palatino-linotype-bold';\r\n\r\n        let left = edge;\r\n        ctx.fillText('1', left, 777);\r\n        left += ctx.measureText('1').width - 2;\r\n\r\n        ctx.font = 'bold 12px palatino-linotype-bold';\r\n        ctx.fillText('st', left, 777 - 5);\r\n        left += ctx.measureText('st').width;\r\n\r\n        ctx.font = 'bold 15px palatino-linotype-bold';\r\n        ctx.fillText(' Edition', left, 777);\r\n    }\r\n};\r\n\r\nexport const drawCreatorText = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    content: string,\r\n) => {\r\n    if (ctx && content) {\r\n        ctx.font = '16px stone-serif-regular';\r\n\r\n        const uncondensableSymbol = '';\r\n        const {\r\n            splittedContent,\r\n            splittedWidth,\r\n            symbolWidth,\r\n            condenseRatio,\r\n        } = measureWithSymbol(ctx, content, uncondensableSymbol, 257);\r\n\r\n        if (condenseRatio < 1) {\r\n            ctx.textAlign = 'left';\r\n            ctx.scale(condenseRatio, 1);\r\n            splittedContent.reduce((prev, cur, index) => {\r\n                // Fill condense text at the current edge\r\n                ctx.fillText(cur, prev / condenseRatio, 777);\r\n                // Increase edge equal to the draw text (condense ratio factored)\r\n                let nextEdge = prev + splittedWidth[index] * condenseRatio;\r\n                if (index < splittedContent.length - 1) {\r\n                    // Restore 1:1 ratio\r\n                    ctx.scale(1 / condenseRatio, 1);\r\n                    // Increase edge equal to the character \"\" (condense ratio is 1 so no factored)\r\n                    ctx.fillText(uncondensableSymbol, nextEdge, 777);\r\n                    nextEdge += symbolWidth;\r\n                    // Restore condense ratio\r\n                    ctx.scale(condenseRatio, 1);\r\n                }\r\n                return nextEdge;\r\n            }, 496 - 257);\r\n            ctx.scale(1 / condenseRatio, 1);\r\n        } else {\r\n            ctx.textAlign = 'right';\r\n            fillTextRightWithSpacing(ctx, content, -0.15, 496 / condenseRatio, 777);\r\n        }\r\n        ctx.textAlign = 'left';\r\n    }\r\n};\r\n\r\nexport const drawAD = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    value: string | number,\r\n    edge: number,\r\n    baseline: number,\r\n) => {\r\n    if (ctx && value !== undefined) {\r\n        if (value === '') {\r\n            ctx.textAlign = 'right';\r\n            ctx.font = 'bold 25px matrix';\r\n            ctx.fillText(value, edge + 49.94, baseline);\r\n        } else {\r\n            ctx.textAlign = 'left';\r\n            const tokenizedText = `${value}`.split('?');\r\n\r\n            let totalWidth = tokenizedText.reduce((prev, curr, index) => {\r\n                ctx.font = '25px MatrixBoldSmallCaps';\r\n                let nextWidth = prev + ctx.measureText(curr).width;\r\n\r\n                if (index < tokenizedText.length - 1) {\r\n                    ctx.font = '25px matrix';\r\n                    nextWidth += ctx.measureText('?').width;\r\n                }\r\n\r\n                return nextWidth;\r\n            }, 0);\r\n\r\n            if (totalWidth > 0) {\r\n                const condenseRatio = Math.min(49.94 / totalWidth, 1);\r\n\r\n                ctx.scale(condenseRatio, 1);\r\n                tokenizedText.reduce((prev, curr, index, arr) => {\r\n                    const curText = arr[arr.length - 1 - index];\r\n                    let nextEdge = prev;\r\n                    ctx.font = '25px MatrixBoldSmallCaps';\r\n                    nextEdge -= ctx.measureText(curText).width * condenseRatio;\r\n                    ctx.fillText(curText, nextEdge / condenseRatio, baseline);\r\n\r\n                    if (index < tokenizedText.length - 1) {\r\n                        ctx.font = 'bold 25px matrix';\r\n                        nextEdge -= ctx.measureText('?').width * condenseRatio;\r\n                        ctx.fillText('?', nextEdge / condenseRatio, baseline);\r\n                    }\r\n    \r\n                    return nextEdge;\r\n                }, edge + 49.94);\r\n                ctx.scale(1 / condenseRatio, 1);\r\n            }\r\n        }\r\n    }\r\n};","import { TypeSize } from '../const';\r\n\r\ntype Aligment = 'left' | 'right';\r\nexport const drawBracketTemplate = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    content: string,\r\n    size: TypeSize,\r\n    alignment: Aligment,\r\n) => {\r\n    return (edge: number) => {\r\n        if (ctx) {\r\n            const {\r\n                top: baseline,\r\n                bracketSize: { char: bracketChar, bracketOffsetTop }\r\n            } = size;\r\n            const alignmentOffset = alignment === 'left' ? 1 : -1;\r\n\r\n            ctx.font = `bold ${bracketChar}px stone-serif-bold`;\r\n            ctx.textAlign = alignment;\r\n            ctx.fillText(content, edge, baseline - bracketOffsetTop);\r\n            return edge + ctx.measureText(content).width * alignmentOffset;\r\n        }\r\n        return edge;\r\n    };\r\n};\r\nexport const drawIconSpaceTemplate = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    size: TypeSize,\r\n    alignment: Aligment,\r\n) => {\r\n    return (edge: number) => {\r\n        if (ctx) {\r\n            const { iconSpace } = size;\r\n            const alignmentOffset = alignment === 'left' ? 1 : -1;\r\n\r\n            return edge + iconSpace * alignmentOffset;\r\n        }\r\n        return edge;\r\n    };\r\n};\r\nexport const drawBracketSpaceTemplate = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    content: string,\r\n    size: TypeSize,\r\n    alignment: Aligment,\r\n) => {\r\n    return (edge: number) => {\r\n        if (ctx) {\r\n            const { top: baseline, bracketSize: { bracketSpace } } = size;\r\n            const alignmentOffset = alignment === 'left' ? 1 : -1;\r\n\r\n            ctx.font = `bold ${bracketSpace}px stone-serif-bold`;\r\n            ctx.textAlign = alignment;\r\n            ctx.fillText(content, edge, baseline);\r\n            return edge + ctx.measureText(content).width * alignmentOffset;\r\n        }\r\n        return edge;\r\n    };\r\n};\r\nexport const drawTextTemplate = (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    content: string,\r\n    isLast = false,\r\n    size: TypeSize,\r\n    alignment: Aligment,\r\n) => {\r\n    const {\r\n        top: baseline,\r\n        spaceSize: { frontSpace, char: spaceChar, behindSpace },\r\n        upperCaseScale,\r\n        upperCaseSize,\r\n        lowerCaseScale,\r\n        lowerCaseSize,\r\n        spaceScale,\r\n    } = size;\r\n    const alignmentOffset = alignment === 'left' ? 1 : -1;\r\n    const drawSlashTemplate = (\r\n        ctx: CanvasRenderingContext2D,\r\n        baseOffset: number,\r\n    ) => {\r\n        let totalOffset = baseOffset;\r\n        ctx.font = `bold ${frontSpace}px stone-serif-bold`;\r\n        ctx.fillText(' ', totalOffset, baseline);\r\n        totalOffset += ctx.measureText(' ').width * alignmentOffset;\r\n\t\r\n        ctx.font = `oblique bold ${spaceChar}px stone-serif-bold`;\r\n        ctx.scale(0.65, 1);\r\n        ctx.fillText('/', totalOffset / 0.65, baseline);\r\n        totalOffset += ctx.measureText('/').width * 0.65 * alignmentOffset;\r\n        ctx.scale(1 / 0.65, 1);\r\n\t\r\n        ctx.font = `bold ${behindSpace}px stone-serif-bold`;\r\n        ctx.fillText(' ', totalOffset, baseline);\r\n        totalOffset += ctx.measureText(' ').width * alignmentOffset;\r\n        return totalOffset;\r\n    };\r\n\r\n    return (left: number) => {\r\n        let totalOffset = left;\r\n        if (ctx) {\r\n            ctx.textAlign = alignment;\r\n\r\n            if (!isLast && alignment === 'right') totalOffset = drawSlashTemplate(ctx, totalOffset);\r\n            content\r\n                .split('')\r\n                .forEach((c, index, arr) => {\r\n                    const char = alignment === 'left' ? arr[index] : arr[arr.length - 1 - index];\r\n                    if (/[A-Z]/.test(char)) {\r\n                        ctx.font = `bold ${upperCaseSize}px stone-serif-bold`;\r\n                        ctx.scale(upperCaseScale, 1);\r\n                        ctx.fillText(char, totalOffset / upperCaseScale, baseline);\r\n                        totalOffset += ctx.measureText(char).width * upperCaseScale * alignmentOffset;\r\n                        ctx.scale(1 / upperCaseScale, 1);\r\n                    } else if (/\\s/.test(char)) {\r\n                        ctx.font = `bold ${lowerCaseSize}px stone-serif-bold`;\r\n                        ctx.scale(spaceScale, 1);\r\n                        ctx.fillText(char, totalOffset / spaceScale, baseline);\r\n                        totalOffset += ctx.measureText(char).width * spaceScale * alignmentOffset;\r\n                        ctx.scale(1 / spaceScale, 1);\r\n                    } else {\r\n                        const upperChar = char.toLocaleUpperCase();\r\n                        ctx.font = `bold ${lowerCaseSize}px stone-serif-bold`;\r\n                        ctx.scale(lowerCaseScale, 1);\r\n                        ctx.fillText(upperChar, totalOffset / lowerCaseScale, baseline);\r\n                        totalOffset += ctx.measureText(upperChar).width * lowerCaseScale * alignmentOffset;\r\n                        ctx.scale(1 / lowerCaseScale, 1);\r\n                    }\r\n                });\r\n            if (!isLast && alignment === 'left') totalOffset = drawSlashTemplate(ctx, totalOffset);\r\n            return totalOffset;\r\n        }\r\n        return totalOffset;\r\n    };\r\n};","const imageCacheMap: Record<string, {\r\n    image: HTMLImageElement,\r\n    ready: boolean,\r\n}> = {};\r\n\r\nexport const drawFromSource = async (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    source: string,\r\n    sx: number | ((image: HTMLImageElement) => number),\r\n    sy: number | ((image: HTMLImageElement) => number),\r\n) => {\r\n    if (!ctx) return new Promise<boolean>(resolve => resolve(false));\r\n    return new Promise<boolean>(resolve => {\r\n        if (imageCacheMap[source]?.ready === true) {\r\n            const img = imageCacheMap[source].image;\r\n            let normalizedX = typeof sx === 'number' ? sx : sx(img);\r\n            let normalizedY = typeof sy === 'number' ? sy : sy(img);\r\n            ctx.drawImage(img, normalizedX, normalizedY);\r\n            resolve(true);\r\n        } else {\r\n            const img = new Image();\r\n            img.src = process.env.PUBLIC_URL + source;\r\n            img.onload = () => {\r\n                let normalizedX = typeof sx === 'number' ? sx : sx(img);\r\n                let normalizedY = typeof sy === 'number' ? sy : sy(img);\r\n                ctx.drawImage(img, normalizedX, normalizedY);\r\n                imageCacheMap[source].ready = true;\r\n                resolve(true);\r\n            };\r\n            img.onerror = () => {\r\n                resolve(false);\r\n            };\r\n            imageCacheMap[source] = {\r\n                image: img,\r\n                ready: false,\r\n            };\r\n        }\r\n    });\r\n};\r\n\r\nexport const drawFromSourceWithSize = async (\r\n    ctx: CanvasRenderingContext2D | null | undefined,\r\n    source: string,\r\n    sx: number | ((image: HTMLImageElement) => number),\r\n    sy: number | ((image: HTMLImageElement) => number),\r\n    dw: number, dh: number,\r\n) => {\r\n    if (!ctx) return new Promise<boolean>(resolve => resolve(false));\r\n    return new Promise<boolean>(resolve => {\r\n        if (imageCacheMap[source]?.ready === true) {\r\n            const img = imageCacheMap[source].image;\r\n            let normalizedX = typeof sx === 'number' ? sx : sx(img);\r\n            let normalizedY = typeof sy === 'number' ? sy : sy(img);\r\n            ctx.drawImage(img, normalizedX, normalizedY, dw, dh);\r\n            resolve(true);\r\n        } else {\r\n            const img = new Image();\r\n            img.src = process.env.PUBLIC_URL + source;\r\n            img.onload = () => {\r\n                let normalizedX = typeof sx === 'number' ? sx : sx(img);\r\n                let normalizedY = typeof sy === 'number' ? sy : sy(img);\r\n                ctx.drawImage(img, normalizedX, normalizedY, dw, dh);\r\n                imageCacheMap[source].ready = true;\r\n                resolve(true);\r\n            };\r\n            img.onerror = () => {\r\n                resolve(false);\r\n            };\r\n            imageCacheMap[source] = {\r\n                image: img,\r\n                ready: false,\r\n            };\r\n        }\r\n    });\r\n};","import React, { useCallback, useEffect, useRef, useState } from 'react';\r\nimport './app.scss';\r\nimport 'antd/dist/antd.css';\r\nimport {\r\n    Card,\r\n    defaultCard,\r\n    defaultTextStyle,\r\n    foilStyleMap,\r\n    iconList,\r\n} from './model';\r\nimport {\r\n    cardDataCondenser,\r\n    checkLink,\r\n    checkMonster,\r\n    checkNormal,\r\n    checkXyz,\r\n    getCardFrame,\r\n    insertUrlParam,\r\n    reverseCardDataCondenser,\r\n} from './util';\r\nimport { AppHeader, CardInputPanel, CardInputPanelRef, taintedCanvasWarning } from './page';\r\nimport {\r\n    arrowPositionList,\r\n    foilPosition,\r\n    pendulumFontList,\r\n    pendulumSizeList,\r\n    stFontList,\r\n    stSizeList,\r\n    typeSizeMap,\r\n} from './const';\r\nimport {\r\n    draw1stEdition,\r\n    drawAD,\r\n    drawBracketSpaceTemplate,\r\n    drawBracketTemplate,\r\n    drawCreatorText,\r\n    drawEffect,\r\n    drawIconSpaceTemplate,\r\n    drawName,\r\n    drawScale,\r\n    drawTextTemplate,\r\n    fillTextLeftWithSpacing,\r\n    fillTextRightWithSpacing,\r\n    drawFromSource,\r\n    drawFromSourceWithSize,\r\n} from './draw';\r\nimport WebFont from 'webfontloader';\r\nimport { LoadingOutlined } from '@ant-design/icons';\r\n\r\nfunction App() {\r\n    const [isInitializing, setInitializing] = useState(true);\r\n    const [error, setError] = useState('');\r\n    const [currentCard, setCard] = useState<Card>(defaultCard);\r\n    const [sourceType, setSourceType] = useState<'internal' | 'external'>('external');\r\n    const cardInputRef = useRef<CardInputPanelRef>(null);\r\n    const previewCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const drawCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const frameCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const artCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const specialFrameCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const subFamilyCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const pendulumScaleCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const pendulumEffectCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const typeCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const effectCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const nameCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const attributeCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const ADCanvasRef = useRef<HTMLCanvasElement>(null);\r\n    const setIdRef = useRef<HTMLCanvasElement>(null);\r\n    const passcodeRef = useRef<HTMLCanvasElement>(null);\r\n    const creatorRef = useRef<HTMLCanvasElement>(null);\r\n    const stickerRef = useRef<HTMLCanvasElement>(null);\r\n\r\n    const {\r\n        frame, foil,\r\n        name, nameStyleType, nameStyle,\r\n        pictureCrop,\r\n        effect,\r\n        type_ability,\r\n        isPendulum, pendulum_effect, blue_scale, red_scale,\r\n        atk, def, link_map,\r\n        attribute,\r\n        subFamily,\r\n        star,\r\n        set_id,\r\n        passcode, isFirstEdition, creator, sticker,\r\n    } = currentCard;\r\n    const isNormal = checkNormal(currentCard);\r\n    const isXyz = checkXyz(currentCard);\r\n    const isLink = checkLink(currentCard);\r\n    const isMonster = checkMonster(currentCard);\r\n    const pendulumSize = 'medium';\r\n\r\n    const drawingPipeline = useRef<Record<string, () => Promise<any>>>({\r\n        frame: () => Promise.resolve(),\r\n        star: () => Promise.resolve(),\r\n        attribute: () => Promise.resolve(),\r\n        specialFrame: () => Promise.resolve(),\r\n        sticker: () => Promise.resolve(),\r\n    });\r\n    const [imageChangeCount, setImageChangeCount] = useState(0);\r\n\r\n    useEffect(() => {\r\n        const ctx = frameCanvasRef.current?.getContext('2d');\r\n\r\n        drawingPipeline.current.frame = async () => {\r\n            ctx?.clearRect(0, 0, 549, 800);\r\n            const cardType = getCardFrame(frame);\r\n            const hasFoil = foil !== 'normal';\r\n\r\n            await drawFromSource(ctx, `/asset/image/frame/frame-${cardType}.png`, 0, 0);\r\n            if (hasFoil) {\r\n                const { art } = foilPosition[foil];\r\n\r\n                await drawFromSource(ctx, `/asset/image/frame/frame-art-${foil}.png`, art.left, 120);\r\n                await drawFromSource(ctx, `/asset/image/frame/frame-effect-${foil}.png`, 0, 580);\r\n            }\r\n        };\r\n    }, [foil, frame]);\r\n\r\n    useEffect(() => {\r\n        const ctx = artCanvasRef.current?.getContext('2d');\r\n        const previewCtx = previewCanvasRef.current;\r\n        if (previewCtx && ctx) {\r\n            ctx.clearRect(0, 0, 548, 650);\r\n            if (isPendulum) {\r\n                ctx.drawImage(previewCtx, 38, 144, 474, 470);\r\n            } else {\r\n                ctx.drawImage(previewCtx, 67, 147, 416, 416);\r\n            }\r\n        }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [isPendulum, imageChangeCount]);\r\n\r\n    useEffect(() => {\r\n        const ctx = specialFrameCanvasRef.current?.getContext('2d');\r\n        \r\n        drawingPipeline.current.specialFrame = async () => {\r\n            ctx?.clearRect(0, 0, 549, 800);\r\n            const hasFoil = foil !== 'normal';\r\n\r\n            const cardType = getCardFrame(frame);\r\n            if (isPendulum && !isLink) {\r\n                if (!isXyz) await drawFromSource(ctx, `/asset/image/pendulum/overlay-pendulum-${cardType}.png`, 0, 0);\r\n                await drawFromSource(ctx, `/asset/image/frame/frame-pendulum-${pendulumSize}.png`, 0, 0);\r\n                if (hasFoil) await drawFromSource(ctx, `/asset/image/frame/frame-pendulum-${pendulumSize}-${foil}.png`, 0, 0);\r\n            }\r\n\r\n            const foiledBorder = !hasFoil ? '/asset/image/frame/frame-border.png' : `/asset/image/frame/frame-border-${foil}.png`;\r\n            await drawFromSource(ctx, foiledBorder, 0, 0);\r\n            if (!isPendulum && isLink) {\r\n                if (hasFoil) await drawFromSource(ctx, `./asset/image/link/link-overlay-${foil}.png`, 0, 110);\r\n                else await drawFromSource(ctx, '/asset/image/link/link-overlay.png', 66, 146);\r\n                if (hasFoil) await drawFromSource(ctx, `/asset/image/link/link-overlay-arrow-${foil}.png`, 0, 110);\r\n\r\n                await Promise.all(link_map\r\n                    .map(entry => {\r\n                        const { left, top, height, width } = arrowPositionList[parseInt(entry) - 1];\r\n                        if (hasFoil) return drawFromSourceWithSize(ctx, `/asset/image/link/link-arrow-${entry}-${foil}.png`, left, top, width, height);\r\n                        else return drawFromSourceWithSize(ctx, `/asset/image/link/link-arrow-${entry}.png`, left, top, width, height);\r\n                    })\r\n                );\r\n                if (ctx) {\r\n                    ctx.textAlign = 'right';\r\n                    ctx.scale(1.2, 1);\r\n                    ctx.font = 'bold 24px Yugioh Rush Duel Numbers V4';\r\n                    ctx.fillText(`${link_map.length}`, 505 / 1.2, 746);\r\n                    ctx.scale(1 / 1.2, 1);\r\n                    ctx.textAlign = 'left';\r\n                }\r\n            }\r\n        };\r\n    }, [foil, frame, isLink, isPendulum, isXyz, link_map]);\r\n\r\n    useEffect(() => {\r\n        const ctx = attributeCanvasRef.current?.getContext('2d');\r\n        drawingPipeline.current.attribute = () => {\r\n            ctx?.clearRect(0, 0, 549, 100);\r\n\r\n            return drawFromSource(ctx, `/asset/image/attribute/attr-${attribute.toLowerCase()}.png`, 458, 37);\r\n        };\r\n    }, [attribute]);\r\n\r\n    useEffect(() => {\r\n        const ctx = subFamilyCanvasRef.current?.getContext('2d');\r\n        drawingPipeline.current.star = () => {\r\n            ctx?.clearRect(0, 0, 549, 150);\r\n            if (isMonster && !isLink) {\r\n                let counter = Math.min(13, star ?? 0);\r\n                let type = isXyz ? 'rank' : 'level';\r\n                let offset = 0 - (34 + 2.3636);\r\n                let totalWidth = 34 * counter + 2.3636 * (counter - 1);\r\n                let edge = counter <= 12\r\n                    ? isXyz\r\n                        ? 57 - 34\r\n                        : 492\r\n                    : isXyz\r\n                        ? (549 - totalWidth) / 2 - 34\r\n                        : (549 - totalWidth) / 2 + totalWidth;\r\n    \r\n                return Promise.all([...Array(counter)]\r\n                    .map(() => {\r\n                        offset += (34 + 2.3636);\r\n                        return drawFromSource(\r\n                            ctx,\r\n                            `/asset/image/sub-family/subfamily-${type}.png`,\r\n                            edge + (34 + offset) * (isXyz ? 1 : -1),\r\n                            99,\r\n                        );\r\n                    })\r\n                );\r\n            } else if (!isMonster) {\r\n                const normalizedSubFamily = subFamily.toUpperCase();\r\n                const hasSTIcon = normalizedSubFamily !== 'NO ICON'\r\n                        && iconList.includes(normalizedSubFamily);\r\n    \r\n                return hasSTIcon\r\n                    ? drawFromSourceWithSize(ctx, `/asset/image/sub-family/subfamily-${normalizedSubFamily.toLowerCase()}.png`,\r\n                        (image) => 491 - image.naturalWidth - 7,\r\n                        103,\r\n                        29, 29)\r\n                    : new Promise(resolve => resolve(true));\r\n            };\r\n            return new Promise(resolve => resolve(true));\r\n        };\r\n    }, [isLink, isMonster, isXyz, star, subFamily]);\r\n\r\n    useEffect(() => {\r\n        const ctx = pendulumScaleCanvasRef.current?.getContext('2d');\r\n        ctx?.clearRect(0, 0, 549, 600);\r\n        if (ctx && isPendulum) {\r\n            let fontSize = 43;\r\n            let top = 532 + fontSize;\r\n\r\n            ctx.font = `${fontSize}px MatrixBoldSmallCaps`;\r\n            ctx.textAlign = 'left';\r\n\r\n            drawScale(ctx, blue_scale ?? 0, 57, top);\r\n            drawScale(ctx, red_scale ?? 0, 493, top);\r\n        }\r\n    }, [isInitializing, blue_scale, isPendulum, red_scale]);\r\n\r\n    useEffect(() => {\r\n        const ctx = nameCanvasRef.current?.getContext('2d');\r\n        if (ctx) {\r\n            ctx.clearRect(0, 0, 549, 100);\r\n            ctx.textAlign = 'left';\r\n            const style = nameStyleType === 'auto'\r\n                ? foil !== 'normal'\r\n                    ? foilStyleMap[foil] ?? defaultTextStyle\r\n                    : { ...defaultTextStyle, fillStyle: (!isMonster || isLink || isXyz) ? '#ffffff' : '#000000' }\r\n                : nameStyle;\r\n\r\n            drawName(ctx, name, 40.52, 78, 409, style);\r\n        }\r\n    }, [foil, isInitializing, isLink, isMonster, isXyz, name, nameStyle, nameStyleType]);\r\n\r\n    useEffect(() => {\r\n        const ctx = ADCanvasRef.current?.getContext('2d');\r\n        ctx?.clearRect(0, 0, 549, 800);\r\n        if (isMonster) {\r\n            drawAD(ctx, atk, 343.51, 747);\r\n            if (!isLink) {\r\n                drawAD(ctx, def, 454.93, 747);\r\n            }\r\n        }\r\n    }, [isInitializing, atk, def, isLink, isMonster]);\r\n\r\n    useEffect(() => {\r\n        const ctx = setIdRef.current?.getContext('2d');\r\n        ctx?.clearRect(0, 0, 549, 800);\r\n        if (ctx) {\r\n            if (isXyz && !isPendulum) ctx.fillStyle = '#fff';\r\n            else ctx.fillStyle = '#000';\r\n            ctx.font = '15px stone-serif-regular';\r\n\r\n            if (isPendulum) {\r\n                fillTextLeftWithSpacing(ctx, set_id, -0.1, 45, 746);\r\n            } else if (isLink) {\r\n                fillTextRightWithSpacing(ctx, set_id, -0.1, 450, 590);\r\n            } else fillTextRightWithSpacing(ctx, set_id, -0.1, 492, 589);\r\n        }\r\n    }, [isInitializing, isLink, isPendulum, isXyz, set_id]);\r\n\r\n    useEffect(() => {\r\n        const ctx = passcodeRef.current?.getContext('2d');\r\n        ctx?.clearRect(0, 0, 549, 800);\r\n        if (ctx) {\r\n            if (isXyz && !isPendulum) ctx.fillStyle = '#fff';\r\n            else ctx.fillStyle = '#000';\r\n            ctx.font = '15px stone-serif-regular';\r\n\r\n            const endOfPasscode = fillTextLeftWithSpacing(ctx, passcode, 0.1, 25, 777);\r\n            if (isFirstEdition) {\r\n                if (isXyz && !isPendulum) ctx.fillStyle = '#fff';\r\n                else ctx.fillStyle = '#000';\r\n\r\n                draw1stEdition(ctx, Math.max(endOfPasscode + 10, 96));\r\n            }\r\n        }\r\n    }, [isFirstEdition, isInitializing, isLink, isPendulum, isXyz, passcode]);\r\n\r\n    useEffect(() => {\r\n        const ctx = creatorRef.current?.getContext('2d');\r\n        ctx?.clearRect(0, 0, 549, 800);\r\n        if (ctx) {\r\n            if (isXyz && !isPendulum) ctx.fillStyle = '#fff';\r\n            else ctx.fillStyle = '#000';\r\n            \r\n            drawCreatorText(ctx, creator);\r\n        }\r\n    }, [isInitializing, isLink, isPendulum, isXyz, creator]);\r\n\r\n    useEffect(() => {\r\n        const ctx = stickerRef.current?.getContext('2d');\r\n        drawingPipeline.current.sticker = () => {\r\n            ctx?.clearRect(0, 0, 549, 800);\r\n\r\n            if (sticker === 'no-sticker') return Promise.resolve();\r\n            return drawFromSource(ctx, `/asset/image/sticker/sticker-${sticker.toLowerCase()}.png`, 499, 750);\r\n        };\r\n    }, [sticker]);\r\n\r\n    const drawTypeAbility  = useCallback((\r\n        ctx: CanvasRenderingContext2D | null | undefined,\r\n        textSize: 'small' | 'medium' | 'large',\r\n        alignment: 'left' | 'right' = 'left',\r\n    ) => {\r\n        if (ctx) {\r\n            ctx?.clearRect(0, 0, 549, 700);\r\n            const size = typeSizeMap[textSize] ?? typeSizeMap['medium'];\r\n            const { left } = size;\r\n            const normalizedSubFamily = subFamily.toUpperCase();\r\n            const instructionList = [\r\n                drawBracketTemplate(ctx, '[', size, alignment),\r\n                drawBracketSpaceTemplate(ctx, ' ', size, alignment),\r\n                ...type_ability.map((entry, index) => drawTextTemplate(\r\n                    ctx,\r\n                    entry,\r\n                    index === type_ability.length - 1,\r\n                    size, alignment)),\r\n                textSize === 'large'\r\n                    ? normalizedSubFamily === 'NO ICON'\r\n                        ? (edge: number) => edge + 4 * (alignment === 'left' ? 1 : -1)\r\n                        : drawIconSpaceTemplate(ctx, size, alignment)\r\n                    : (edge: number) => edge + 2,\r\n                drawBracketTemplate(ctx, ']', size, alignment),\r\n            ];\r\n            const totalLeft = (alignment === 'left'\r\n                ? instructionList\r\n                : instructionList.reverse()).reduce((prev, curr) => {\r\n                return curr(prev);\r\n            }, left);\r\n            ctx.textAlign = 'left';\r\n            if (totalLeft > 508 && textSize === 'medium') drawTypeAbility(ctx, 'small', alignment);\r\n        }\r\n    }, [subFamily, type_ability]);\r\n    useEffect(() => {\r\n        const ctx = effectCanvasRef.current?.getContext('2d');\r\n        const typeCtx = typeCanvasRef.current?.getContext('2d');\r\n        ctx?.clearRect(0, 0, 549, 750);\r\n        if (isMonster) {\r\n            const effectIndexSize = drawEffect(ctx, effect, false, isNormal);\r\n            drawTypeAbility(typeCtx, effectIndexSize === 0\r\n                ? 'medium'\r\n                : 'small');\r\n        } else {\r\n            drawEffect(\r\n                ctx,\r\n                effect,\r\n                false,\r\n                false,\r\n                stFontList,\r\n                stSizeList,\r\n            );\r\n            drawTypeAbility(typeCtx, 'large', 'right');\r\n        }\r\n    }, [isInitializing, drawTypeAbility, effect, isMonster, isNormal]);\r\n    useEffect(() => {\r\n        const ctx = pendulumEffectCanvasRef.current?.getContext('2d');\r\n        ctx?.clearRect(0, 0, 549, 600);\r\n        if (isMonster && isPendulum) {\r\n            drawEffect(\r\n                ctx,\r\n                pendulum_effect,\r\n                true,\r\n                false,\r\n                pendulumFontList,\r\n                pendulumSizeList,\r\n            );\r\n        }\r\n    }, [isInitializing, isMonster, isPendulum, pendulum_effect]);\r\n\r\n    // const drawRefrenceImage = useCallback(async (ctx: CanvasRenderingContext2D | null | undefined) => {\r\n    //     let leftOffset = -5;\r\n    //     let topOffset = 150;\r\n    // let leftOffset = -4;\r\n    // let topOffset = 300;\r\n    // let leftOffset = -300;\r\n    // let topOffset = -7;\r\n    // let leftOffset = -1;\r\n    // let topOffset = 100;\r\n    // await drawFromSourceWithSize(ctx, '/asset/image/MP19-EN-C-1E.png', -leftOffset, -topOffset, 541, 800 * (541 / 549));\r\n    // }, []);\r\n\r\n    useEffect(() => {\r\n        const ctx = drawCanvasRef.current?.getContext('2d');\r\n        if (ctx) {\r\n            ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n            ctx.imageSmoothingQuality = 'high';\r\n            ctx.clearRect(0, 0, 549, 800);\r\n        }\r\n        \r\n        // let fontLoaded = false;\r\n        WebFont.load({\r\n            custom: {\r\n                families: [\r\n                    'stone-serif-bold',\r\n                    'stone-serif-bold',\r\n                    'stone-serif-regular',\r\n                    'matrix',\r\n                    'palatino-linotype-bold',\r\n                    'MatrixBook',\r\n                    'MatrixBoldSmallCaps',\r\n                    'MatrixRegularSmallCaps',\r\n                    'Yugioh Rush Duel Numbers V4',\r\n                ],\r\n                urls: ['asset/font.css']\r\n            },\r\n            active: () => {\r\n                try {\r\n                    const localCardVersion = window.localStorage.getItem('card-version');\r\n                    const localCardData = window.localStorage.getItem('card-data');\r\n\r\n                    const urlParam = (new URLSearchParams(window.location.search)).get('data');\r\n                    if (urlParam) {\r\n                        setCard(reverseCardDataCondenser(urlParam) as any);\r\n                    } else if (localCardData !== null && localCardVersion === process.env.REACT_APP_VERSION) {\r\n                        setCard(JSON.parse(localCardData));\r\n                    }\r\n                } catch (e) {\r\n                    setCard(defaultCard);\r\n                }\r\n                setInitializing(false);\r\n            },\r\n            inactive: () => {\r\n                setError('Font could not be loaded');\r\n                setInitializing(false);\r\n            },\r\n        });\r\n    }, []);\r\n\r\n    const pendingSave = useRef(false);\r\n    const exportRef = useRef({\r\n        currentPipeline: Promise.resolve(),\r\n        queuedPipeline: false,\r\n    });\r\n\r\n    const download = useCallback(() => {\r\n        const canvasRef = drawCanvasRef.current;\r\n        if (canvasRef) try {\r\n            var link = document.createElement('a');\r\n            link.download = `${name}.png`;\r\n            link.href = canvasRef.toDataURL('image/png');\r\n            link.click();\r\n        } catch (e) {\r\n            setTainted(true);\r\n            alert('Could not save card, please manually save it by right click the card  Choose \"Save image as...\"');\r\n        }\r\n        document.querySelector('#export-canvas-guard')?.classList.remove('guard-on');\r\n    }, [name]);\r\n    const [isTainted, setTainted] = useState(false);\r\n    const onSave = () => {\r\n        document.querySelector('#export-canvas-guard')?.classList.add('guard-on');\r\n        if (exportRef.current.queuedPipeline === false) {\r\n            download();\r\n        } else pendingSave.current = true;\r\n    };\r\n\r\n    useEffect(() => {\r\n        let relevant = true;\r\n        if (isInitializing === false) {\r\n            localStorage.setItem('card-data', JSON.stringify(currentCard));\r\n            localStorage.setItem('card-version', process.env.REACT_APP_VERSION ?? 'unknown');\r\n\r\n            /**\r\n             * Run export pipeline\r\n             * - While it is running, every effect just mark pipeline as queued, then wait the current pipeline\r\n             * - If the pipeline is complete and there is no effect, run another pipeline and remove the queue\r\n             */\r\n            (async () => {\r\n                const canvasRef = drawCanvasRef.current;\r\n                if (canvasRef) {\r\n                    document.getElementById('export-canvas-guard')?.setAttribute('style', '');\r\n                    document.getElementById('save-button-waiting')?.setAttribute('style', 'display: block');\r\n                    document.getElementById('save-button-ready')?.setAttribute('style', 'display: none');\r\n\r\n                    exportRef.current.queuedPipeline = true;\r\n                    await exportRef.current.currentPipeline;\r\n\r\n                    if (relevant) {\r\n                        exportRef.current.currentPipeline = onExport({ isPendulum });\r\n                        exportRef.current.queuedPipeline = false;\r\n\r\n                        await exportRef.current.currentPipeline;\r\n                        if (relevant) {\r\n                            const condensedCard = cardDataCondenser(currentCard);\r\n                            if (typeof condensedCard === 'string') insertUrlParam('data', condensedCard);\r\n\r\n                            document.getElementById('export-canvas-guard')?.setAttribute('style', 'display: none');\r\n                            document.getElementById('save-button-waiting')?.setAttribute('style', 'display: none');\r\n                            document.getElementById('save-button-ready')?.setAttribute('style', 'display: block');\r\n\r\n                            if (pendingSave.current) {\r\n                                pendingSave.current = false;\r\n                                download();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            })();\r\n        }\r\n\r\n        return () => {\r\n            relevant = false;\r\n        };\r\n    });\r\n\r\n    const onExport = useRef(async (exportProps: {\r\n        isPendulum: boolean,\r\n    }) => {\r\n        const {\r\n            isPendulum = false\r\n        } = exportProps;\r\n        const canvasRef = drawCanvasRef.current;\r\n        const exportCtx = canvasRef?.getContext('2d');\r\n        const generateLayer = (canvasLayer: React.RefObject<HTMLCanvasElement>, ctx: CanvasRenderingContext2D | null | undefined) => {\r\n            return new Promise<boolean>(resolve => {\r\n                if (canvasLayer.current && ctx) {\r\n                    const layerData = canvasLayer.current.toDataURL('image/png');\r\n\r\n                    if (layerData) {\r\n                        var layer = new Image();\r\n                        layer.src = layerData;\r\n                        layer.onload = () => {\r\n                            ctx.drawImage(layer, 0, 0);\r\n                            resolve(true);\r\n                        };\r\n                        layer.onerror = () => resolve(false);\r\n                    } else resolve(false);\r\n                } else resolve(false);\r\n            });\r\n        };\r\n\r\n        if (canvasRef && exportCtx) {\r\n            exportCtx.clearRect(0, 0, 549, 800);\r\n            await Promise.all(Object\r\n                .values(drawingPipeline.current)\r\n                .map(callDraw => {\r\n                    return callDraw();\r\n                }));\r\n            await generateLayer(frameCanvasRef, exportCtx);\r\n            const previewCtx = previewCanvasRef.current;\r\n            if (previewCtx && exportCtx) {\r\n                if (isPendulum) {\r\n                    exportCtx.drawImage(previewCtx, 38, 144, 474, 470);\r\n                } else {\r\n                    exportCtx.drawImage(previewCtx, 67, 147, 416, 416);\r\n                }\r\n            }\r\n            await generateLayer(specialFrameCanvasRef, exportCtx);\r\n            const layerList = [\r\n                nameCanvasRef,\r\n                attributeCanvasRef,\r\n                subFamilyCanvasRef,\r\n                pendulumScaleCanvasRef,\r\n                pendulumEffectCanvasRef,\r\n                typeCanvasRef,\r\n                effectCanvasRef,\r\n                ADCanvasRef,\r\n                setIdRef,\r\n                passcodeRef,\r\n                creatorRef,\r\n                stickerRef,\r\n            ];\r\n            await Promise.all([\r\n                layerList.map(currentlayer => generateLayer(currentlayer, exportCtx)),\r\n            ]);\r\n            // await drawRefrenceImage(exportCtx);\r\n        }\r\n    }).current;\r\n\r\n    return (\r\n        <div id=\"app\"\r\n            onDrop={() => {}}\r\n            style={{\r\n                backgroundImage: `url(\"${process.env.PUBLIC_URL}/asset/image/texture/debut-dark.png\"), linear-gradient(180deg, #00000022, #00000044)`,\r\n            }}\r\n        >\r\n            <div className={'app-container'}>\r\n                {isInitializing && <div className=\"full-loading\">\r\n                    {error.length > 0 ? <span style={{ color: '#e04040' }}>\r\n                        {error}\r\n                    </span> : 'Loading fonts and scripts...'}\r\n                </div>}\r\n                {/* <div className=\"card-filter-panel\">\r\n                </div> */}\r\n                <div className={`card-preview-panel ${isTainted ? 'export-tainted' : 'export-normal'}`}>\r\n                    <div className=\"export-button\">\r\n                        {!isTainted\r\n                            ? <>Canvas is safe<br />\r\n                                <button id=\"save-button-waiting\" disabled>Generating...</button>\r\n                                <button id=\"save-button-ready\" onClick={() => onSave()}>Save</button></>\r\n                            : <><div>Canvas is tainted {taintedCanvasWarning}</div>\r\n                        Manually save by right click the card  \"Save image as...\"</>}\r\n                        <div className=\"imexport\">\r\n                            <button onClick={() => {\r\n                                if (sourceType === 'internal') window.alert('Cannot export card data if you use offline image');\r\n\r\n                                window.prompt('Save card data for later use', `${cardDataCondenser(currentCard)}`);\r\n                            }}>Export Card Data</button>\r\n                            <button onClick={() => {\r\n                                const cardData = window.prompt('Paste your card data');\r\n\r\n                                if (cardData) {\r\n                                    const decodedCard = reverseCardDataCondenser(cardData) as Card;\r\n                                    setCard(decodedCard);\r\n                                    cardInputRef.current?.forceCardData(decodedCard);\r\n                                }\r\n                            }}>Import Card Data</button>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"card-canvas-group\">\r\n                        <canvas id=\"export-canvas\" ref={drawCanvasRef} width={549} height={800} />\r\n                        <div id=\"export-canvas-guard\">\r\n                            <div className=\"canvas-guard-alert\">Generating...</div>\r\n                            <LoadingOutlined />\r\n                        </div>\r\n                        <canvas id=\"frameCanvas\" ref={frameCanvasRef} width={549} height={800} />\r\n                        <canvas id=\"artCanvas\" ref={artCanvasRef} width={549} height={650} />\r\n                        <canvas id=\"specialFrameCanvas\" ref={specialFrameCanvasRef} width={549} height={800} />\r\n                        <canvas id=\"nameCanvas\" ref={nameCanvasRef} width={549} height={100} />\r\n                        <canvas id=\"attributeCanvas\" ref={attributeCanvasRef} width={549} height={100} />\r\n                        <canvas id=\"subFamilyCanvas\" ref={subFamilyCanvasRef} width={549} height={150} />\r\n                        <canvas id=\"pendulumScaleCanvas\" ref={pendulumScaleCanvasRef} width={549} height={600} />\r\n                        <canvas id=\"pendulumEffectCanvas\" ref={pendulumEffectCanvasRef} width={549} height={600} />\r\n                        <canvas id=\"typeCanvas\" ref={typeCanvasRef} width={549} height={700} />\r\n                        <canvas id=\"effectCanvas\" ref={effectCanvasRef} width={549} height={750} />\r\n                        <canvas id=\"ADCanvas\" ref={ADCanvasRef} width={549} height={800} />\r\n                        <canvas id=\"setId\" ref={setIdRef} width={549} height={800} />\r\n                        <canvas id=\"passcode\" ref={passcodeRef} width={549} height={800} />\r\n                        <canvas id=\"creator\" ref={creatorRef} width={549} height={800} />\r\n                        <canvas id=\"sticker\" ref={stickerRef} width={549} height={800} />\r\n                        <canvas className=\"crop-canvas\" ref={previewCanvasRef} />\r\n                    </div>\r\n                </div>\r\n                {isInitializing === false && <CardInputPanel\r\n                    ref={cardInputRef}\r\n                    receivingCanvasRef={previewCanvasRef.current}\r\n                    currentCard={currentCard}\r\n                    onCardChange={setCard}\r\n                    defaultCropInfo={pictureCrop}\r\n                    onImageChange={(cropInfo, sourceType) => {\r\n                        setImageChangeCount(cnt => cnt + 1);\r\n                        setSourceType(sourceType);\r\n                        if (cropInfo) setCard(curr => ({\r\n                            ...curr,\r\n                            pictureCrop: cropInfo,\r\n                        }));\r\n                    }}\r\n                    onTainted={() => setTainted(true)}\r\n                >\r\n                    <AppHeader /><br />\r\n                </CardInputPanel>}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\n    if (onPerfEntry && onPerfEntry instanceof Function) {\n        import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n            getCLS(onPerfEntry);\n            getFID(onPerfEntry);\n            getFCP(onPerfEntry);\n            getLCP(onPerfEntry);\n            getTTFB(onPerfEntry);\n        });\n    }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './app';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}